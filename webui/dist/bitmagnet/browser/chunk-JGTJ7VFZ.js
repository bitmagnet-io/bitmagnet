import{g as J,j as A}from"./chunk-6OKZFKY7.js";import{A as z,J as H,P as q,R as K,Ua as Q,b as T,ba as M,ca as I,da as W,fa as N,ga as V,ha as y,i as S,o as P,p as L,wa as R,z as Y}from"./chunk-HB55W55I.js";import"./chunk-6XXA7HXI.js";import"./chunk-ZBBMS7J5.js";import{$b as a,B as $,Cb as x,Ea as u,Fa as m,Hb as g,Mb as w,N as F,Nb as B,Ob as O,Pb as G,Qb as s,Rb as r,Sb as b,Tb as E,Ub as v,Wb as h,Zb as _,kb as o,kc as c,lc as d,mc as f,nc as U,o as j,pc as k,qa as C,ua as D}from"./chunk-FJILXII2.js";function ce(n,p){if(n&1){let e=h();s(0,"section")(1,"mat-checkbox",4),_("change",function(i){u(e);let l=a(2);return m(l.purge=i.checked)}),c(2),r(),b(3,"br"),s(4,"mat-checkbox",4),_("change",function(i){u(e);let l=a(2);return l.localSearchDisabled=!i.checked,m(l.apisDisabled=l.localSearchDisabled?!0:l.apisDisabled)}),c(5),r(),b(6,"br"),s(7,"mat-checkbox",4),_("change",function(i){u(e);let l=a(2);return l.apisDisabled=!i.checked,m(l.localSearchDisabled=l.apisDisabled?l.localSearchDisabled:!0)}),c(8),r(),b(9,"br"),s(10,"mat-checkbox",4),_("change",function(i){u(e);let l=a(2);return m(l.classifierRematch=i.checked)}),c(11),r(),b(12,"br"),s(13,"mat-checkbox",4),_("change",function(i){u(e);let l=a(2);return m(l.orphans=i.checked)}),c(14),r()()}if(n&2){let e=a().$implicit,t=a();o(),g("checked",t.purge),o(),d(e("dashboard.queues.purge_queue_jobs")),o(2),g("checked",!t.apisDisabled),o(),d(e("dashboard.queues.match_content_by_local_search")),o(2),g("checked",!t.apisDisabled),o(),d(e("dashboard.queues.match_content_by_external_api_search")),o(2),g("checked",t.classifierRematch),o(),d(e("dashboard.queues.force_rematch")),o(2),g("checked",t.orphans),o(),d(e("dashboard.queues.process_orphaned_torrents_only"))}}function le(n,p){n&1&&b(0,"mat-spinner")}function ue(n,p){if(n&1&&(s(0,"p"),c(1),r()),n&2){let e=a().$implicit;o(),d(e("dashboard.queues.jobs_enqueued"))}}function me(n,p){if(n&1){let e=h();E(0),s(1,"mat-card")(2,"h2",1),c(3),r(),s(4,"mat-dialog-content"),x(5,ce,15,10,"section")(6,le,1,0,"mat-spinner")(7,ue,2,1,"p"),r(),s(8,"mat-dialog-actions")(9,"button",2),_("click",function(){u(e);let i=a();return m(i.handleEnqueue())}),c(10),r(),s(11,"button",3),_("click",function(){u(e);let i=a();return m(i.dialogRef.close())}),c(12),r()()(),v()}if(n&2){let e=p.$implicit,t=a();o(3),f(" ",e("dashboard.queues.enqueue_torrent_processing_batch")," "),o(2),w(t.stage==="PENDING"?5:t.stage==="REQUESTING"?6:t.stage==="DONE"?7:-1),o(4),g("disabled",t.stage!=="PENDING"),o(),f(" ",e("dashboard.queues.enqueue_jobs")," "),o(2),f(" ",e("general.dismiss")," ")}}var ne=(()=>{class n{constructor(){this.apollo=C(S),this.dialogRef=C(I),this.availableQueueNames=A,this.statusNames=J,this.stage="PENDING",this.purge=!0,this.apisDisabled=!0,this.localSearchDisabled=!0,this.classifierRematch=!1,this.orphans=!1}handleEnqueue(){this.stage==="PENDING"&&(this.stage="REQUESTING",this.apollo.mutate({mutation:Y,variables:{input:{purge:this.purge,apisDisabled:this.apisDisabled,localSearchDisabled:this.localSearchDisabled,classifierRematch:this.classifierRematch,contentTypes:this.contentTypes,orphans:this.orphans?!0:void 0}}}).subscribe(()=>{this.stage="DONE",this.data.onEnqueued?.()}))}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=D({type:n,selectors:[["app-queue-enqueue-reprocess-torrents-batch-dialog"]],standalone:!0,features:[k],decls:1,vars:0,consts:[[4,"transloco"],["mat-dialog-title",""],["mat-stroked-button","","color","warning",3,"click","disabled"],["mat-stroked-button","",3,"click"],[3,"change","checked"]],template:function(t,i){t&1&&x(0,me,13,5,"ng-container",0)},dependencies:[Q,P,q,M,N,y,V,R,T],styles:["mat-dialog-content[_ngcontent-%COMP%]{min-height:240px;overflow:visible}mat-grid-tile[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]{width:100%;height:100%}"]})}}return n})();function _e(n,p){if(n&1){let e=h();s(0,"mat-checkbox",6),_("change",function(i){u(e);let l=a(3);return m(l.handleQueueEvent(i))}),c(1),r()}if(n&2){let e=p.$implicit,t=a(3);g("value",e)("checked",t.queues==null?null:t.queues.includes(e)),o(),d(e)}}function pe(n,p){if(n&1){let e=h();s(0,"mat-checkbox",6),_("change",function(i){u(e);let l=a(3);return m(l.handleStatusEvent(i))}),c(1),r()}if(n&2){let e=p.$implicit,t=a(2).$implicit,i=a();g("value",e)("checked",i.statuses==null?null:i.statuses.includes(e)),o(),d(t("general.status"))}}function de(n,p){if(n&1){let e=h();s(0,"section")(1,"h4"),c(2),r(),s(3,"mat-checkbox",4),_("change",function(i){u(e);let l=a(2);return m(l.handleQueueEvent(i))}),c(4),r(),O(5,_e,2,3,"mat-checkbox",5,B),r(),s(7,"section")(8,"h4"),c(9),r(),s(10,"mat-checkbox",4),_("change",function(i){u(e);let l=a(2);return m(l.handleStatusEvent(i))}),c(11),r(),O(12,pe,2,3,"mat-checkbox",5,B),r()}if(n&2){let e=a().$implicit,t=a();o(2),f("",e("dashboard.queues.queues"),":"),o(),g("checked",t.queues===void 0),o(),d(e("general.all")),o(),G(t.availableQueueNames),o(4),f("",e("general.status"),":"),o(),g("checked",t.statuses===void 0),o(),d(e("general.all")),o(),G(t.statusNames)}}function ge(n,p){n&1&&b(0,"mat-spinner")}function he(n,p){if(n&1&&(s(0,"p"),c(1),r()),n&2){let e=a(2).$implicit,t=a();o(),U("",e("general.error"),": ",t.error.message,"")}}function xe(n,p){if(n&1&&(s(0,"p"),c(1),r()),n&2){let e=a(2).$implicit;o(),d(e("dashboard.queues.queue_purged"))}}function fe(n,p){if(n&1&&x(0,he,2,2,"p")(1,xe,2,1,"p"),n&2){let e=a(2);w(e.error?0:1)}}function Ce(n,p){if(n&1){let e=h();E(0),s(1,"mat-card")(2,"h2",1),c(3),r(),s(4,"mat-dialog-content"),x(5,de,14,6)(6,ge,1,0,"mat-spinner")(7,fe,2,1),r(),s(8,"mat-dialog-actions")(9,"button",2),_("click",function(){u(e);let i=a();return m(i.handlePurgeJobs())}),c(10),r(),s(11,"button",3),_("click",function(){u(e);let i=a();return m(i.dialogRef.close())}),c(12),r()()(),v()}if(n&2){let e=p.$implicit,t=a();o(3),d(e("dashboard.queues.purge_queue_jobs")),o(2),w(t.stage==="PENDING"?5:t.stage==="REQUESTING"?6:t.stage==="DONE"?7:-1),o(4),g("disabled",t.stage!=="PENDING"),o(),f(" ",e("dashboard.queues.purge_jobs")," "),o(2),f(" ",e("general.dismiss")," ")}}var ie=(()=>{class n{constructor(){this.apollo=C(S),this.dialogRef=C(I),this.availableQueueNames=A,this.statusNames=J,this.stage="PENDING"}handleQueueEvent(e){if(e.source.value==="_all"){this.queues=void 0;return}if(e.checked){let t=this.queues??[];t.includes(e.source.value)||(t=[...t,e.source.value]),t.length===this.availableQueueNames.length?(e.source.checked=!1,this.queues=void 0):this.queues=t}else{let t=this.queues?.filter(i=>i!==e.source.value);t?.length?this.queues=t:this.queues=void 0}}handleStatusEvent(e){if(e.source.value==="_all"){this.statuses=void 0;return}if(e.checked){let t=this.statuses??[];t.includes(e.source.value)||(t=[...t,e.source.value]),t.length===this.statusNames.length?(e.source.checked=!1,this.statuses=void 0):this.statuses=t}else{let t=this.statuses?.filter(i=>i!==e.source.value);t?.length?this.statuses=t:this.statuses=void 0}}handlePurgeJobs(){this.stage==="PENDING"&&(this.stage="REQUESTING",this.apollo.mutate({mutation:z,variables:{input:{queues:this.queues,statuses:this.statuses}}}).pipe(F(e=>(this.stage="DONE",this.error=e,j)),$(()=>{this.stage="DONE",this.data?.onPurged?.()})).subscribe())}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=D({type:n,selectors:[["app-queue-purge-jobs-dialog"]],standalone:!0,features:[k],decls:1,vars:0,consts:[[4,"transloco"],["mat-dialog-title",""],["mat-stroked-button","","color","warning",3,"click","disabled"],["mat-stroked-button","",3,"click"],["value","_all",3,"change","checked"],[3,"value","checked"],[3,"change","value","checked"]],template:function(t,i){t&1&&x(0,Ce,13,5,"ng-container",0)},dependencies:[Q,P,q,M,N,y,V,R,T,H],styles:["mat-dialog-content[_ngcontent-%COMP%]{min-height:240px;overflow:visible}mat-grid-tile[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]{width:100%;height:100%}"]})}}return n})();function be(n,p){if(n&1){let e=h();E(0),s(1,"mat-card")(2,"mat-card-content")(3,"ul")(4,"li")(5,"a",1),_("click",function(){u(e);let i=a();return m(i.openDialogPurgeJobs())}),c(6),r()(),s(7,"li")(8,"a",1),_("click",function(){u(e);let i=a();return m(i.openDialogEnqueueReprocessTorrentsBatch())}),c(9),r()()()()(),v()}if(n&2){let e=p.$implicit;o(6),d(e("dashboard.queues.purge_queue_jobs")),o(3),d(e("dashboard.queues.enqueue_torrent_processing_batch"))}}var ze=(()=>{class n{constructor(){this.dialog=C(W)}openDialogPurgeJobs(){this.dialog.open(ie)}openDialogEnqueueReprocessTorrentsBatch(){this.dialog.open(ne)}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=D({type:n,selectors:[["app-queue-admin"]],standalone:!0,features:[k],decls:1,vars:0,consts:[[4,"transloco"],["mat-button","",3,"click"]],template:function(t,i){t&1&&x(0,be,10,2,"ng-container",0)},dependencies:[Q,L,q,K,T],styles:["ul[_ngcontent-%COMP%]{list-style-type:none;padding-left:0}ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:6px}"]})}}return n})();export{ze as QueueAdminComponent};
