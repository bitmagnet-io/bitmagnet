import{B as J,J as K,P as T,Q as U,R as X,U as k,b as M,da as Y,ea as Z,fa as tt,ga as et,ha as nt,i as z,ia as it,na as at,o as b,qa as u,r as H,sa as ot,ta as rt,ya as lt}from"./chunk-HB55W55I.js";import{$b as l,B as F,Cb as s,Ea as Q,Fa as A,Hb as V,Kb as G,Mb as v,Ob as P,Pb as $,Qb as r,Rb as o,Sb as _,Tb as f,Ub as C,Wb as N,Zb as R,a as I,b as D,jc as q,kb as a,kc as c,l as j,la as W,lc as m,mc as g,nc as y,qa as p,rc as S,ua as x,va as B,yc as L}from"./chunk-FJILXII2.js";var w={error:"error",degraded:"warning",down:"warning",unknown:"pending",inactive:"circle",up:"check_circle",started:"play_circle"},ct={status:"unknown",checks:[],icon:w.unknown,workers:[],error:null},mt=1e4,h=class{constructor(){this.apollo=p(z),this.resultSubject=new j(ct),this.result$=this.resultSubject.asObservable(),this.result=ct,this.watchQuery(),this.result$.subscribe(i=>{this.result=i})}watchQuery(){this.apollo.watchQuery({query:J,fetchPolicy:"no-cache",pollInterval:mt}).valueChanges.pipe(F(i=>({status:i.data.health.status==="down"?"degraded":i.data.health.status,checks:i.data.health.checks.map(e=>D(I({},e),{icon:w[e.status]})),workers:i.data.workers.listAll.workers.map(e=>D(I({},e),{icon:w[e.started?"started":"inactive"]})),icon:w[i.data.health.status],error:null}))).subscribe({next:i=>this.resultSubject.next(i),error:i=>{this.resultSubject.next({status:"error",checks:[],workers:[],error:i,icon:w.error}),setTimeout(this.watchQuery.bind(this),mt)}})}};var st=(t,i)=>i.key;function xt(t,i){if(t&1&&(r(0,"p"),c(1),o()),t&2){let e=l().$implicit,n=l();a(),y("",e("health.check_failed_with_error"),": ",n.health.result.error,"")}}function ft(t,i){if(t&1&&(r(0,"th"),c(1),o()),t&2){let e=l(2).$implicit;a(),m(e("general.error"))}}function Ct(t,i){if(t&1&&(r(0,"td"),c(1),o()),t&2){let e=l().$implicit;a(),m(e.error)}}function gt(t,i){if(t&1&&(r(0,"tr")(1,"td",2)(2,"mat-icon"),c(3),o()(),r(4,"th",3),c(5),o(),r(6,"td"),c(7),o(),s(8,Ct,2,1,"td"),o()),t&2){let e=i.$implicit,n=l(2).$implicit,d=l();a(3),m(e.icon),a(2),m(n("health.components."+e.key)),a(2),m(n("health.statuses."+e.status)),a(),v(d.health.result.status==="down"?8:-1)}}function Mt(t,i){t&1&&_(0,"td")}function vt(t,i){if(t&1&&(r(0,"tr")(1,"td",2)(2,"mat-icon"),c(3),o()(),r(4,"th",3),c(5),o(),r(6,"td"),c(7),o(),s(8,Mt,1,0,"td"),o()),t&2){let e=i.$implicit,n=l(2).$implicit,d=l();a(3),m(e.icon),a(2),y(" ",n("health.worker"),": ",n("health.workers."+e.key)," "),a(2),g(" ",n("health.statuses."+(e.started?"started":"inactive"))," "),a(),v(d.health.result.status==="down"?8:-1)}}function yt(t,i){if(t&1&&(r(0,"table",1)(1,"thead")(2,"tr"),_(3,"th"),r(4,"th"),c(5),o(),r(6,"th"),c(7),o(),s(8,ft,2,1,"th"),o()(),r(9,"tbody"),P(10,gt,9,4,"tr",null,st),P(12,vt,9,5,"tr",null,st),o()()),t&2){let e=l().$implicit,n=l();a(5),m(e("health.component")),a(2),m(e("general.status")),a(),v(n.health.result.status==="down"?8:-1),a(2),$(n.health.result.checks),a(2),$(n.health.result.workers)}}function St(t,i){if(t&1&&(f(0),s(1,xt,2,2,"p")(2,yt,14,3,"table",1),C()),t&2){let e=l();a(),v(e.health.result.error?1:2)}}var E=(()=>{class t{constructor(){this.health=p(h)}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275cmp=x({type:t,selectors:[["app-health-summary"]],decls:1,vars:0,consts:[[4,"transloco"],[1,"table-health"],[1,"td-icon"],["scope","row"]],template:function(n,d){n&1&&s(0,St,3,1,"ng-container",0)},dependencies:[M,u],styles:[".table-health[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table-health[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding-right:20px}.table-health[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{text-align:left}"]})}}return t})();var wt=t=>({status:t});function bt(t,i){if(t&1&&(f(0),r(1,"mat-card",1)(2,"mat-card-header")(3,"mat-card-title")(4,"h3")(5,"mat-icon"),c(6),o(),c(7),o()()(),r(8,"mat-card-content",2),_(9,"app-health-summary"),o()(),C()),t&2){let e=i.$implicit,n=l();a(6),m(n.health.result.icon),a(),g(" ",e("health.bitmagnet_is_status",S(2,wt,e("health.statuses."+(n.health.result.error?"down":n.health.result.status))))," ")}}var Vt=(()=>{class t{constructor(){this.health=p(h)}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275cmp=x({type:t,selectors:[["app-health-card"]],decls:1,vars:0,consts:[[4,"transloco"],[1,"dashboard-card","dashboard-card-health"],[1,"dashboard-card-content"]],template:function(n,d){n&1&&s(0,bt,10,4,"ng-container",0)},dependencies:[M,u,T,X,k,U,E],styles:[".dashboard-card-health[_ngcontent-%COMP%]{position:absolute;inset:15px}.dashboard-card-health[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-top:0}.dashboard-card-health[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{position:relative;top:3px;margin-left:4px;margin-right:6px}"]})}}return t})();var ut=t=>({status:t});function Ht(t,i){if(t&1&&(r(0,"h2",3),c(1),o(),r(2,"mat-dialog-content"),_(3,"app-health-summary"),o(),r(4,"mat-dialog-actions")(5,"button",4),c(6),o()()),t&2){let e=l().$implicit,n=l();a(),y(" ",e("health.summary"),": ",e("health.bitmagnet_is_status",S(3,ut,e("health.statuses."+(n.health.result.error?"down":n.health.result.status))))," "),a(5),g(" ",e("general.dismiss")," ")}}function Tt(t,i){if(t&1){let e=N();f(0),r(1,"button",2),R("click",function(){Q(e);let d=q(5),_t=l();return A(_t.dialog.open(d))}),r(2,"mat-icon"),c(3),o()(),s(4,Ht,7,5,"ng-template",null,0,L),C()}if(t&2){let e=i.$implicit,n=l();a(),G("health-icon health-icon-"+n.health.result.status),V("matTooltip",e("health.bitmagnet_is_status",S(4,ut,e("health.statuses."+n.health.result.status)))),a(2),m(n.health.result.icon)}}var Ut=(()=>{class t{constructor(){this.health=p(h),this.dialog=p(Y)}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275cmp=x({type:t,selectors:[["app-health-widget"]],decls:1,vars:0,consts:[["healthDialog",""],[4,"transloco"],["mat-icon-button","",3,"click","matTooltip"],["matDialogTitle",""],["mat-button","","matDialogClose","","color","primary"]],template:function(n,d){n&1&&s(0,Tt,6,6,"ng-container",1)},dependencies:[M,u,lt,Z,tt,nt,et,b,H,E]})}}return t})();var _e=(()=>{class t{static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275mod=B({type:t})}static{this.\u0275inj=W({providers:[h],imports:[K,u,it,b,H,T,k,at,rt,ot]})}}return t})();export{h as a,Vt as b,Ut as c,_e as d};
