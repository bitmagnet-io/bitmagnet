import{a as Ue,b as Ge,c as Z,d as Ke,e as Ye,f as ee,g as Je,h as We,i as Q,j as Xe,k as Ze,l as et}from"./chunk-6OKZFKY7.js";import{a as $e,b as He,c as E}from"./chunk-TJLO75RV.js";import{e as X}from"./chunk-Y7K23DTG.js";import{b as Re}from"./chunk-RQ2LQKI2.js";import{l as Fe}from"./chunk-42PJPEMD.js";import{a as we}from"./chunk-ASLGZ7DJ.js";import{a as je}from"./chunk-MSAOOVCY.js";import{a as Le}from"./chunk-DSEDLZDW.js";import{D as Te,J as G,M as qe,P as K,Q as Ve,R as Be,U as Y,Ua as Qe,a as H,b as Me,i as xe,ia as Oe,n as ye,na as J,o as Se,oa as Ee,qa as W,r as U,ra as Ie,sa as ze,ta as Ae,va as Ne,ya as De,za as Pe}from"./chunk-VAEZNV34.js";import"./chunk-6XXA7HXI.js";import"./chunk-CMNWCZJM.js";import{$b as f,B as ce,Cb as de,Ea as g,Fa as C,Hb as l,Kb as I,N as le,Nb as z,Ob as A,Pb as N,Q as ne,Qb as s,Rb as u,Sb as L,Tb as fe,Ub as _e,Wb as re,Zb as k,a as x,ad as ve,b as y,ka as R,kb as c,kc as _,l as P,la as ue,lc as T,mc as he,o as se,pc as be,qa as w,tc as ge,ua as me,va as pe,vc as Ce,wc as ke}from"./chunk-Z3WUIYN5.js";var tt=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=pe({type:n})}static{this.\u0275inj=ue({imports:[G,W,Oe,Se,U,K,Y,J,Ae,ze]})}}return n})();var mt={pending:"primary",processed:"success",failed:"error",retry:"caution"},it=(()=>{class n{constructor(){this.themeInfo=w(X),this.transloco=w(H)}create(e){let{colors:i}=this.themeInfo.info,t=Array(),a=[];if(e&&Array.from(new Set(e.queues.flatMap(v=>v.events?[v.events.earliestBucket,v.events.latestBucket]:[]))).sort().length){let v=e.queues.filter(h=>!h.isEmpty);t.push(...v.map(h=>h.queue));let M=Array();switch(e.params.event){case"created":M.push("pending");break;case"processed":M.push("processed");break;case"failed":M.push("retry","failed");break;default:M.push(...Je);break}a.push(...M.map(h=>({label:this.transloco.translate("dashboard.queues."+h),data:v.map(p=>p.statusCounts[h]),backgroundColor:i[E(mt[h],50)]})))}return{type:"bar",options:{animation:!1,scales:{x:{ticks:{callback:r=>parseInt(r).toLocaleString(this.transloco.getActiveLang())}},y:{}},indexAxis:"y",plugins:{legend:{display:!0}}},data:{labels:t,datasets:a}}}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=R({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var j="\\d+",oe="".concat(j,"(?:[\\.,]").concat(j,")?"),pt="(".concat(j,"Y)?(").concat(j,"M)?(").concat(j,"W)?(").concat(j,"D)?"),dt="T(".concat(oe,"H)?(").concat(oe,"M)?(").concat(oe,"S)?"),ft="P(?:".concat(pt,"(?:").concat(dt,")?)"),_t=["years","months","weeks","days","hours","minutes","seconds"],nt={years:0,months:0,weeks:0,days:0,hours:0,minutes:0,seconds:0},ht=new RegExp(ft),rt=function(n){let o=n.replace(/,/g,".").match(ht);if(!o)throw new RangeError("invalid duration: ".concat(n));let e=o.slice(1);if(e.filter(function(i){return i!=null}).length===0)throw new RangeError("invalid duration: ".concat(n));if(e.filter(function(i){return/\./.test(i||"")}).length>1)throw new RangeError("only the smallest unit can be fractional");return e.reduce(function(i,t,a){return Object.assign(i,{[_t[a]]:parseFloat(t||"0")||0}),i},{})},bt=function(n,o){o||(o=new Date);let e=Object.assign({},nt,n),i=o.getTime(),t=new Date(i);t.setFullYear(t.getFullYear()+e.years),t.setMonth(t.getMonth()+e.months),t.setDate(t.getDate()+e.days);let a=e.hours*3600*1e3,r=e.minutes*60*1e3;return t.setMilliseconds(t.getMilliseconds()+e.seconds*1e3+a+r),t.setDate(t.getDate()+e.weeks*7),t},at=function(n,o){o||(o=new Date);let e=Object.assign({},nt,n),i=o.getTime(),t=new Date(i),a=bt(e,t),r=o.getTimezoneOffset(),v=a.getTimezoneOffset(),M=(r-v)*60;return(a.getTime()-t.getTime())/1e3+M};var te=class{constructor(o,e=Ke,i){this.apollo=o,this.errorsService=i,this.rawResultSubject=new P({queue:{metrics:{buckets:[]}}}),this.resultSubject=new P(Ye),this.result$=this.resultSubject.asObservable(),this.loadingSubject=new P(!1),this.paramsSubject=new P(e),this.params$=this.paramsSubject.asObservable(),this.variablesSubject=new P(ot(e)),this.paramsSubject.pipe(ne(50)).subscribe(t=>{let a=this.variablesSubject.getValue(),r=ot(t);JSON.stringify(a)!==JSON.stringify(r)?this.variablesSubject.next(r):this.resultSubject.next(ct(t,this.rawResultSubject.getValue()))}),this.variablesSubject.pipe(ne(50)).subscribe(t=>this.request(t)),this.rawResultSubject.subscribe(t=>{let a=this.paramsSubject.getValue();this.resultSubject.next(ct(a,t)),this.setInterval(a.autoRefresh)})}setInterval(o){clearTimeout(this.refreshTimeout);let e=et[o??this.params.autoRefresh];e&&(this.refreshTimeout=setTimeout(()=>{this.refresh()},e*1e3))}get params(){return this.paramsSubject.getValue()}get bucketDuration(){let o=this.params.buckets.duration;return o==="AUTO"?"hour":o}get bucketMultiplier(){return this.resultSubject.getValue().params.buckets.multiplier??this.params.buckets.multiplier}get loading(){return this.loadingSubject.getValue()}setTimeframe(o){this.updateParams(e=>y(x({},e),{buckets:y(x({},e.buckets),{timeframe:o})}))}setQueue(o){this.updateParams(e=>y(x({},e),{queue:o??void 0}))}setBucketDuration(o,e){this.updateParams(i=>y(x({},i),{buckets:y(x({},i.buckets),{duration:o,multiplier:e??"AUTO"})}))}setBucketMultiplier(o){this.updateParams(e=>y(x({},e),{buckets:y(x({},e.buckets),{multiplier:o})}))}setEvent(o){this.updateParams(e=>y(x({},e),{event:o??void 0}))}setAutoRefreshInterval(o){this.updateParams(e=>y(x({},e),{autoRefresh:o}))}updateParams(o){this.paramsSubject.next(o(this.params))}refresh(){this.variablesSubject.next(this.variablesSubject.getValue())}request(o){return clearTimeout(this.refreshTimeout),this.loadingSubject.next(!0),this.apollo.query({query:Te,variables:o,fetchPolicy:"no-cache"}).pipe(ce(e=>{e&&(this.loadingSubject.next(!1),this.rawResultSubject.next(e.data))})).pipe(le(e=>(this.errorsService.addError(`Failed to load queue metrics: ${e.message}`),this.loadingSubject.next(!1),this.setInterval(),se))).subscribe()}},ot=n=>({input:{bucketDuration:n.buckets.duration==="AUTO"?"hour":n.buckets.duration,queues:n.queue?[n.queue]:void 0,startTime:n.buckets.timeframe==="all"?void 0:new Date(new Date().getTime()-1e3*Q[n.buckets.timeframe]).toISOString()}}),st=n=>Object.fromEntries(n),ct=(n,o)=>{let{bucketParams:e,earliestBucket:i,latestBucket:t}=gt(n,o),a=Object.entries(o.queue.metrics.buckets.reduce((h,p)=>{if(p.queue!==(n.queue??p.queue))return h;let d,m;if((n.event??!0)&&(d=q(p.createdAtBucket,e),i&&i.index>d.index&&(d=void 0)),p.ranAtBucket&&n.event!=="created"&&(m=q(p.ranAtBucket,e),m&&(t.index<m.index||i&&i.index>m.index)&&(m=void 0)),p.queue!==n.queue&&!d&&(!m||p.status==="pending"))return h;let[V,b]=h[p.queue]??[Ue,[]],S=p.latency?at(rt(p.latency)):void 0;return y(x({},h),{[p.queue]:[(p.status==="pending"?d:m)?y(x({},V),{[p.status]:p.count+V[p.status]}):V,{created:d?y(x({},b.created),{[d.key]:{count:p.count+(b.created?.[d.key]?.count??0),latency:0,startTime:d.start}}):b.created,processed:m&&p.status==="processed"&&(n.event??!0)?y(x({},b.processed),{[m.key]:{count:p.count+(b.processed?.[m.key]?.count??0),latency:(b.processed?.[m.key]?.latency??0)+(S??0),startTime:m.start}}):b.processed,failed:m&&p.status==="failed"&&(n.event??!0)?y(x({},b.failed),{[m.key]:{count:p.count+(b.failed?.[m.key]?.count??0),latency:(b.failed?.[m.key]?.latency??0)+(S??0),startTime:m.start}}):b.failed}]})},{})).map(([h,[p,d]])=>{let m;if(Object.keys(d).length){let V=Array(),b=st(Array("created","processed","failed").flatMap(S=>{let B=st(Object.entries(d[S]??{}).filter(([,ie])=>ie?.count).sort(([ie],[ut])=>parseInt(ie)<parseInt(ut)?1:-1)),O=Object.keys(B);if(!O.length)return[];let F=parseInt(O[0]),D=parseInt(O[O.length-1]);return V.push(F,D),[[S,{earliestBucket:F,latestBucket:D,entries:B}]]}));V.sort(),m={bucketDuration:e.duration,earliestBucket:V[0],latestBucket:V[V.length-1],eventBuckets:b}}return{queue:h,statusCounts:p,events:m,isEmpty:!m?.eventBuckets}}),r,v=a.flatMap(h=>h.events?[h.events.earliestBucket]:[]).sort()[0],M=a.flatMap(h=>h.events?[h.events.latestBucket]:[]).sort().reverse()[0];return v&&M&&(r={earliestBucket:v,latestBucket:M}),{params:y(x({},n),{buckets:e}),queues:a,bucketSpan:r}},gt=(n,o)=>{let e=n.buckets.duration==="AUTO"?"hour":n.buckets.duration,i=n.buckets.multiplier==="AUTO"?1:n.buckets.multiplier,t=n.buckets.timeframe,a=new Date,r=q(a,{duration:e,multiplier:i}),v=t==="all"?void 0:q(a.getTime()-1e3*Q[t],{duration:e,multiplier:i}),M=[...v?[v]:[],...o.queue.metrics.buckets.flatMap(d=>[q(d.createdAtBucket,{duration:e,multiplier:i}),...d.ranAtBucket?[q(d.ranAtBucket,{duration:e,multiplier:i})]:[]]),r].filter(d=>!v||d.index>=v.index).sort((d,m)=>d.index-m.index),h=M[0],p=M[M.length-1];if(n.buckets.multiplier==="AUTO"){let m=p.index-h.index;i=Math.min(60,Math.max(Math.floor(m/(20*5))*5,1))}return{bucketParams:{duration:e,multiplier:i,timeframe:t},earliestBucket:t==="all"?void 0:q(a.getTime()-1e3*Q[t],{duration:e,multiplier:i}),latestBucket:q(Math.max(a.getTime(),p.start.getTime()),{duration:e,multiplier:i})}},q=(n,o)=>{let e=new Date(n),i=1e3*Z[o.duration]*o.multiplier,t=Math.floor(e.getTime()/i);return{key:`${t}`,index:t,start:new Date(t*i)}};var $={created:"primary",processed:"success",failed:"error"},lt=(()=>{class n{constructor(){this.themeInfo=w(X),this.transloco=w(H)}create(e){let{colors:i}=this.themeInfo.info,t=Array(),a=[];if(e){let r=e.queues.filter(d=>!d.isEmpty),v=Array.from(new Set(r.flatMap(d=>d.events?[d.events.earliestBucket,d.events.latestBucket]:[]))).sort(),M=new Date,h=e.params.buckets.timeframe==="all"?v[0]:Math.min(v[0],q(M.getTime()-1e3*Q[e.params.buckets.timeframe],e.params.buckets).index),p=Math.max(v[v.length-1],q(M,e.params.buckets).index);if(v.length){for(let m=h;m<=p;m++)t.push(this.formatBucketKey(e.params.buckets,m));let d=ee.filter(m=>(e.params.event??m)===m);for(let m of r){for(let b of d){let S=Array();for(let B=h;B<=p;B++)S.push(m.events?.eventBuckets?.[b]?.entries?.[`${B}`]?.count??0);a.push({yAxisID:"yCount",label:m.queue+": "+this.transloco.translate("dashboard.queues."+b),data:S,borderColor:i[E($[b],50)],pointBackgroundColor:i[E($[b],20)],pointBorderColor:i[E($[b],80)],pointHoverBackgroundColor:i[E($[b],40)],pointHoverBorderColor:i[E($[b],60)]})}if(["processed","failed"].filter(b=>d.includes(b)).length){let b=Array();for(let S=h;S<=p;S++){let B=["processed","failed"].filter(O=>d.includes(O)).reduce((O,F)=>{let D=m.events?.eventBuckets?.[F]?.entries?.[`${S}`];return D?.count?[(O?.[0]??0)+D.latency,(O?.[1]??0)+D.count]:O},null);b.push(B?B[0]/B[1]:null)}a.push({yAxisID:"yLatency",label:m.queue+": "+this.transloco.translate("dashboard.queues.latency"),data:b,borderColor:i["tertiary-50"],pointHoverBackgroundColor:i["tertiary-80"],pointHoverBorderColor:i["tertiary-20"]})}}}}return{type:"line",options:{animation:!1,elements:{line:{tension:.5}},scales:{yCount:{position:"left",ticks:{callback:r=>parseInt(r).toLocaleString(this.transloco.getActiveLang())}},yLatency:{position:"right",ticks:{callback:this.formatDuration.bind(this)}}},plugins:{legend:{display:!0},decimation:{enabled:!0},tooltip:{callbacks:{label:r=>r.dataset.yAxisID==="yCount"?r.formattedValue:this.formatDuration(r.parsed.y)}}}},data:{labels:t,datasets:a}}}formatBucketKey(e,i){let t;switch(e.duration){case"day":t="d LLL";break;case"hour":t="d LLL H:00";break;case"minute":t="H:mm";break}return $e(1e3*Z[e.duration]*e.multiplier*i,t,{locale:Fe(this.transloco.getActiveLang())})}formatDuration(e){if(typeof e=="string"&&(e=parseInt(e)),e===0)return"0";let i=e,t=0,a=0,r=0;return i>=60&&(t=Math.floor(i/60),i=i%60,t>=5&&(i=0,t>=60&&(a=Math.floor(t/60),t=t%60,a>=5&&(t=0,a>=24&&(r=Math.floor(a/24),a=a%24))))),i=Math.round(i*100)/100,Re({days:r,hours:a,minutes:t,seconds:i},this.transloco.getActiveLang())}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=R({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var Ct=(n,o,e)=>[n,o,e];function kt(n,o){if(n&1&&(s(0,"mat-option",7),_(1),u()),n&2){let e=o.$implicit,i=f().$implicit;l("value",e),c(),T(i("dashboard.interval."+e))}}function vt(n,o){if(n&1&&(s(0,"mat-option",7),_(1),u()),n&2){let e=o.$implicit,i=f().$implicit;l("value",e),c(),T(i("dashboard.interval."+e+"s"))}}function Mt(n,o){if(n&1&&(s(0,"mat-option",7),_(1),u()),n&2){let e=o.$implicit;l("value",e),c(),T(e)}}function xt(n,o){if(n&1){let e=re();s(0,"button",17),k("click",function(){let t=g(e).$implicit,a=f(2);return C(a.queueMetricsController.params.queue===t||a.queueMetricsController.setQueue(t))}),s(1,"mat-icon"),_(2),u()()}if(n&2){let e=o.$implicit,i=f(2);I(i.queueMetricsController.params.queue===e?"selected":"deselected"),l("matTooltip",e),c(2),T(i.queueMetricsController.params.queue===e?"radio_button_checked":"radio_button_unchecked")}}function yt(n,o){if(n&1&&(s(0,"mat-option",7),_(1),u()),n&2){let e=o.$implicit,i=f().$implicit;l("value",e),c(),T(i("dashboard.event."+e))}}function St(n,o){if(n&1&&(s(0,"mat-option",7),_(1),u()),n&2){let e=o.$implicit,i=f().$implicit;l("value",e),c(),T(i("dashboard.interval."+e))}}function wt(n,o){if(n&1){let e=re();fe(0),L(1,"app-document-title",1),s(2,"mat-card")(3,"mat-card-content")(4,"mat-grid-list",2)(5,"mat-grid-tile",3)(6,"mat-card",4)(7,"mat-card-header")(8,"mat-card-title")(9,"h4"),_(10),u()()(),s(11,"mat-card-content")(12,"mat-form-field",5)(13,"mat-select",6),k("valueChange",function(t){g(e);let a=f();return C(a.queueMetricsController.setTimeframe(t))}),A(14,kt,2,2,"mat-option",7,z),u()(),s(16,"div",8)(17,"button",9),k("click",function(){g(e);let t=f();return C(t.queueMetricsController.setTimeframe(t.timeframeNames[0]))}),s(18,"mat-icon"),_(19,"first_page"),u()(),s(20,"button",9),k("click",function(){g(e);let t=f();return C(t.queueMetricsController.setTimeframe(t.timeframeNames[t.timeframeNames.indexOf(t.queueMetricsController.params.buckets.timeframe)-1]))}),s(21,"mat-icon"),_(22,"navigate_before"),u()(),s(23,"button",9),k("click",function(){g(e);let t=f();return C(t.queueMetricsController.setTimeframe(t.timeframeNames[t.timeframeNames.indexOf(t.queueMetricsController.params.buckets.timeframe)+1]))}),s(24,"mat-icon"),_(25,"navigate_next"),u()(),s(26,"button",9),k("click",function(){g(e);let t=f();return C(t.queueMetricsController.setTimeframe(t.timeframeNames[t.timeframeNames.length-1]))}),s(27,"mat-icon"),_(28,"last_page"),u()()()()()(),s(29,"mat-grid-tile",3)(30,"mat-card",10)(31,"mat-card-header")(32,"mat-card-title")(33,"h4"),_(34),u()()(),s(35,"mat-card-content")(36,"mat-form-field",11)(37,"input",12),Ce(38,"async"),k("change",function(t){g(e);let a=f();return C(a.handleMultiplierEvent(t))}),u()(),s(39,"mat-form-field",13)(40,"mat-select",6),k("valueChange",function(t){g(e);let a=f();return C(a.queueMetricsController.setBucketDuration(t))}),A(41,vt,2,2,"mat-option",7,z),u()(),s(43,"div",8)(44,"button",9),k("click",function(){g(e);let t=f();return C(t.queueMetricsController.setBucketMultiplier(t.queueMetricsController.bucketMultiplier-1))}),s(45,"mat-icon"),_(46,"remove"),u()(),s(47,"button",14),k("click",function(){g(e);let t=f();return C(t.queueMetricsController.setBucketMultiplier(t.queueMetricsController.bucketMultiplier+1))}),s(48,"mat-icon"),_(49,"add"),u()(),s(50,"button",9),k("click",function(){g(e);let t=f();return C(t.queueMetricsController.setBucketDuration(t.resolutionNames[0]))}),s(51,"mat-icon"),_(52,"first_page"),u()(),s(53,"button",9),k("click",function(){g(e);let t=f();return C(t.queueMetricsController.setBucketDuration(t.resolutionNames[t.resolutionNames.indexOf(t.queueMetricsController.bucketDuration)-1]))}),s(54,"mat-icon"),_(55,"navigate_before"),u()(),s(56,"button",9),k("click",function(){g(e);let t=f();return C(t.queueMetricsController.setBucketDuration(t.resolutionNames[t.resolutionNames.indexOf(t.queueMetricsController.bucketDuration)+1]))}),s(57,"mat-icon"),_(58,"navigate_next"),u()(),s(59,"button",9),k("click",function(){g(e);let t=f();return C(t.queueMetricsController.setBucketDuration(t.resolutionNames[t.resolutionNames.length-1]))}),s(60,"mat-icon"),_(61,"last_page"),u()()()()()(),s(62,"mat-grid-tile",3)(63,"mat-card")(64,"mat-card-header")(65,"mat-card-title")(66,"h4"),_(67),u()()(),s(68,"mat-card-content")(69,"mat-form-field",5)(70,"mat-select",6),k("valueChange",function(t){g(e);let a=f();return C(a.queueMetricsController.setQueue(t==="_all"?null:t))}),s(71,"mat-option",15),_(72),u(),A(73,Mt,2,2,"mat-option",7,z),u()(),s(75,"div",16)(76,"button",17),k("click",function(){g(e);let t=f();return C(t.queueMetricsController.setQueue(null))}),s(77,"mat-icon",18),_(78,"workspaces"),u()(),A(79,xt,3,4,"button",19,z),u()()()(),s(81,"mat-grid-tile",3)(82,"mat-card")(83,"mat-card-header")(84,"mat-card-title")(85,"h4"),_(86),u()()(),s(87,"mat-card-content")(88,"mat-form-field",5)(89,"mat-select",6),k("valueChange",function(t){g(e);let a=f();return C(a.queueMetricsController.setEvent(t==="_all"?null:t))}),s(90,"mat-option",15),_(91,"All"),u(),A(92,yt,2,2,"mat-option",7,z),u()(),s(94,"div",16)(95,"button",17),k("click",function(){g(e);let t=f();return C(t.queueMetricsController.setEvent(null))}),s(96,"mat-icon",18),_(97,"radio_button_checked"),u()(),s(98,"button",17),k("click",function(){g(e);let t=f();return C(t.queueMetricsController.params.event==="created"||t.queueMetricsController.setEvent("created"))}),s(99,"mat-icon"),_(100,"add_circle"),u()(),s(101,"button",17),k("click",function(){g(e);let t=f();return C(t.queueMetricsController.params.event==="processed"||t.queueMetricsController.setEvent("processed"))}),s(102,"mat-icon"),_(103,"check_circle"),u()(),s(104,"button",17),k("click",function(){g(e);let t=f();return C(t.queueMetricsController.params.event==="failed"||t.queueMetricsController.setEvent("failed"))}),s(105,"mat-icon"),_(106,"error"),u()()()()()(),s(107,"mat-grid-tile",3)(108,"mat-card",20)(109,"mat-card-header")(110,"mat-card-title")(111,"h4"),_(112),u()()(),s(113,"mat-card-content")(114,"mat-form-field",5)(115,"mat-select",6),k("valueChange",function(t){g(e);let a=f();return C(a.queueMetricsController.setAutoRefreshInterval(t))}),A(116,St,2,2,"mat-option",7,z),u()(),s(118,"div",16)(119,"button",17),k("click",function(){g(e);let t=f();return C(t.queueMetricsController.refresh())}),s(120,"mat-icon"),_(121,"sync"),u()()()()()()(),s(122,"div",21),L(123,"mat-progress-bar",22),u(),s(124,"mat-grid-list",2)(125,"mat-grid-tile",3),L(126,"app-chart",23),u(),s(127,"mat-grid-tile",3),L(128,"app-chart",23),u()()()(),_e()}if(n&2){let e,i,t,a=o.$implicit,r=f();c(),l("parts",ge(69,Ct,a("routes.visualize"),a("routes.queues"),a("routes.dashboard"))),c(3),l("cols",r.breakpoints.sizeAtLeast("Large")?5:r.breakpoints.sizeAtLeast("Medium")?3:r.breakpoints.sizeAtLeast("Small")?2:1),c(),l("colspan",1)("rowspan",2),c(5),T(a("dashboard.metrics.timeframe")),c(3),l("value",r.queueMetricsController.params.buckets.timeframe),c(),N(r.timeframeNames),c(3),l("disabled",r.timeframeNames.indexOf(r.queueMetricsController.params.buckets.timeframe)<=0),c(3),l("disabled",r.timeframeNames.indexOf(r.queueMetricsController.params.buckets.timeframe)<=0),c(3),l("disabled",r.timeframeNames.indexOf(r.queueMetricsController.params.buckets.timeframe)>=r.timeframeNames.length-1),c(3),l("disabled",r.timeframeNames.indexOf(r.queueMetricsController.params.buckets.timeframe)>=r.timeframeNames.length-1),c(3),l("colspan",1)("rowspan",2),c(5),he(" ",a("dashboard.metrics.resolution")," "),c(3),l("placeholder",(e=(e=ke(38,67,r.queueMetricsController.result$))==null||e.params==null||e.params.buckets==null||e.params.buckets.multiplier==null?null:e.params.buckets.multiplier.toString())!==null&&e!==void 0?e:"")("value",r.queueMetricsController.params.buckets.multiplier),c(3),l("value",r.queueMetricsController.bucketDuration),c(),N(r.resolutionNames),c(3),l("disabled",r.queueMetricsController.bucketMultiplier===1),c(6),l("disabled",r.resolutionNames.indexOf(r.queueMetricsController.bucketDuration)<=0),c(3),l("disabled",r.resolutionNames.indexOf(r.queueMetricsController.bucketDuration)<=0),c(3),l("disabled",r.resolutionNames.indexOf(r.queueMetricsController.bucketDuration)>=r.resolutionNames.length-1),c(3),l("disabled",r.resolutionNames.indexOf(r.queueMetricsController.bucketDuration)>=r.resolutionNames.length-1),c(3),l("colspan",1)("rowspan",2),c(5),T(a("dashboard.queues.queue")),c(3),l("value",(i=r.queueMetricsController.params.queue)!==null&&i!==void 0?i:"_all"),c(2),T(a("general.all")),c(),N(r.availableQueueNames),c(3),I(r.queueMetricsController.params.queue?"deselected":"selected"),l("matTooltip",a("general.all")),c(3),N(r.availableQueueNames),c(2),l("colspan",1)("rowspan",2),c(5),T(a("dashboard.metrics.event")),c(3),l("value",(t=r.queueMetricsController.params.event)!==null&&t!==void 0?t:"_all"),c(3),N(r.eventNames),c(3),I(r.queueMetricsController.params.event?"deselected":"selected"),l("matTooltip",a("general.all")),c(3),I(r.queueMetricsController.params.event==="created"?"selected":"deselected"),l("matTooltip",a("dashboard.queues.created")),c(3),I(r.queueMetricsController.params.event==="processed"?"selected":"deselected"),l("matTooltip",a("dashboard.queues.processed")),c(3),I(r.queueMetricsController.params.event==="failed"?"selected":"deselected"),l("matTooltip",a("dashboard.queues.failed")),c(3),l("colspan",1)("rowspan",2),c(5),T(a("general.refresh")),c(3),l("value",r.queueMetricsController.params.autoRefresh),c(),N(r.autoRefreshIntervalNames),c(3),l("matTooltip",a("general.refresh")),c(4),l("mode",r.queueMetricsController.loading?"indeterminate":"determinate")("value",0),c(),l("cols",r.breakpoints.sizeAtLeast("Large")?2:1),c(),l("colspan",1)("rowspan",5),c(),l("adapter",r.totals)("$data",r.queueMetricsController.result$)("height",r.breakpoints.sizeAtLeast("Large")?300:500)("width",700)("title",a("dashboard.queues.total_counts_by_status")),c(),l("colspan",1)("rowspan",5),c(),l("adapter",r.timeline)("$data",r.queueMetricsController.result$)("height",r.breakpoints.sizeAtLeast("Large")?300:500)("width",700)("title",a("dashboard.metrics.throughput"))}}var Pi=(()=>{class n{constructor(){this.breakpoints=w(je),this.apollo=w(xe),this.queueMetricsController=new te(this.apollo,{buckets:{duration:"AUTO",multiplier:"AUTO",timeframe:"all"},autoRefresh:"seconds_30"},w(we)),this.timeline=w(lt),this.totals=w(it),this.resolutionNames=Ge,this.timeframeNames=We,this.availableQueueNames=Xe,this.autoRefreshIntervalNames=Ze,this.eventNames=ee}ngOnInit(){this.queueMetricsController.result$.subscribe(e=>{if(this.queueMetricsController.params.buckets.timeframe==="all"&&this.queueMetricsController.params.buckets.duration==="AUTO"&&e.params.buckets.duration==="hour"){let i=e.bucketSpan;i&&i.latestBucket-i.earliestBucket<12&&this.queueMetricsController.setBucketDuration("minute")}})}ngOnDestroy(){this.queueMetricsController.setAutoRefreshInterval("off")}handleMultiplierEvent(e){let i=e.currentTarget.value;this.queueMetricsController.setBucketMultiplier(/^\d+$/.test(i)?parseInt(i):"AUTO")}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=me({type:n,selectors:[["app-queue-visualize"]],standalone:!0,features:[be],decls:1,vars:0,consts:[[4,"transloco"],[3,"parts"],["rowHeight","100px",3,"cols"],[3,"colspan","rowspan"],[1,"form-timeframe"],["subscriptSizing","dynamic"],[3,"valueChange","value"],[3,"value"],[1,"paginator","actions"],["mat-icon-button","",3,"click","disabled"],[1,"form-resolution"],["subscriptSizing","dynamic",1,"form-input-multiplier"],["type","number","matInput","","min","1","step","1",3,"change","placeholder","value"],["subscriptSizing","dynamic",1,"form-select-duration"],["mat-icon-button","",3,"click"],["value","_all"],[1,"actions"],["mat-icon-button","",3,"click","matTooltip"],["fontSet","material-icons"],["mat-icon-button","",3,"class","matTooltip"],[1,"form-refresh"],[1,"progress-bar-container"],[3,"mode","value"],[3,"adapter","$data","height","width","title"]],template:function(i,t){i&1&&de(0,wt,129,73,"ng-container",0)},dependencies:[Qe,ye,U,K,Be,Y,Ve,qe,Ee,J,W,Ie,Ne,Pe,De,Me,ve,He,G,tt,Le],styles:[".actions[_ngcontent-%COMP%]{width:210px;padding-top:12px;--mdc-icon-button-state-layer-size: 32px}.actions[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:22px}.actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-right:0}.progress-bar-container[_ngcontent-%COMP%]{width:100%;height:10px}mat-grid-tile[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]{width:100%}mat-grid-tile[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{min-width:190px}mat-grid-tile[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin-bottom:16px;font-size:18px}mat-form-field[_ngcontent-%COMP%]{width:186px}.form-resolution[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{margin-left:-2px}.form-resolution[_ngcontent-%COMP%]   .form-input-multiplier[_ngcontent-%COMP%]{width:60px;margin-right:10px}.form-resolution[_ngcontent-%COMP%]   .form-input-multiplier[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::-webkit-outer-spin-button, .form-resolution[_ngcontent-%COMP%]   .form-input-multiplier[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.form-resolution[_ngcontent-%COMP%]   .form-input-multiplier[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}.form-resolution[_ngcontent-%COMP%]   .form-select-duration[_ngcontent-%COMP%]{width:116px}"]})}}return n})();export{Pi as QueueVisualizeComponent};
