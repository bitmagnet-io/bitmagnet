import{g as J,j as A}from"./chunk-6OKZFKY7.js";import{a as Z}from"./chunk-DSEDLZDW.js";import{A as H,J as K,P as q,R as W,Ua as Q,b as T,ba as M,ca as I,da as X,fa as N,ga as V,ha as y,i as S,o as P,p as Y,wa as R,z}from"./chunk-VAEZNV34.js";import"./chunk-6XXA7HXI.js";import"./chunk-CMNWCZJM.js";import{$b as a,B as F,Cb as f,Ea as m,Fa as _,Hb as g,Mb as w,N as $,Nb as B,Ob as O,Pb as G,Qb as s,Rb as r,Sb as h,Tb as E,Ub as v,Wb as x,Zb as p,kb as o,kc as c,lc as d,mc as C,nc as U,o as j,pc as k,qa as b,tc as L,ua as D}from"./chunk-Z3WUIYN5.js";function ue(n,u){if(n&1){let e=x();s(0,"section")(1,"mat-checkbox",4),p("change",function(i){m(e);let l=a(2);return _(l.purge=i.checked)}),c(2),r(),h(3,"br"),s(4,"mat-checkbox",4),p("change",function(i){m(e);let l=a(2);return l.localSearchDisabled=!i.checked,_(l.apisDisabled=l.localSearchDisabled?!0:l.apisDisabled)}),c(5),r(),h(6,"br"),s(7,"mat-checkbox",4),p("change",function(i){m(e);let l=a(2);return l.apisDisabled=!i.checked,_(l.localSearchDisabled=l.apisDisabled?l.localSearchDisabled:!0)}),c(8),r(),h(9,"br"),s(10,"mat-checkbox",4),p("change",function(i){m(e);let l=a(2);return _(l.classifierRematch=i.checked)}),c(11),r(),h(12,"br"),s(13,"mat-checkbox",4),p("change",function(i){m(e);let l=a(2);return _(l.orphans=i.checked)}),c(14),r()()}if(n&2){let e=a().$implicit,t=a();o(),g("checked",t.purge),o(),d(e("dashboard.queues.purge_queue_jobs")),o(2),g("checked",!t.apisDisabled),o(),d(e("dashboard.queues.match_content_by_local_search")),o(2),g("checked",!t.apisDisabled),o(),d(e("dashboard.queues.match_content_by_external_api_search")),o(2),g("checked",t.classifierRematch),o(),d(e("dashboard.queues.force_rematch")),o(2),g("checked",t.orphans),o(),d(e("dashboard.queues.process_orphaned_torrents_only"))}}function me(n,u){n&1&&h(0,"mat-spinner")}function _e(n,u){if(n&1&&(s(0,"p"),c(1),r()),n&2){let e=a().$implicit;o(),d(e("dashboard.queues.jobs_enqueued"))}}function pe(n,u){if(n&1){let e=x();E(0),s(1,"mat-card")(2,"h2",1),c(3),r(),s(4,"mat-dialog-content"),f(5,ue,15,10,"section")(6,me,1,0,"mat-spinner")(7,_e,2,1,"p"),r(),s(8,"mat-dialog-actions")(9,"button",2),p("click",function(){m(e);let i=a();return _(i.handleEnqueue())}),c(10),r(),s(11,"button",3),p("click",function(){m(e);let i=a();return _(i.dialogRef.close())}),c(12),r()()(),v()}if(n&2){let e=u.$implicit,t=a();o(3),C(" ",e("dashboard.queues.enqueue_torrent_processing_batch")," "),o(2),w(t.stage==="PENDING"?5:t.stage==="REQUESTING"?6:t.stage==="DONE"?7:-1),o(4),g("disabled",t.stage!=="PENDING"),o(),C(" ",e("dashboard.queues.enqueue_jobs")," "),o(2),C(" ",e("general.dismiss")," ")}}var oe=(()=>{class n{constructor(){this.apollo=b(S),this.dialogRef=b(I),this.availableQueueNames=A,this.statusNames=J,this.stage="PENDING",this.purge=!0,this.apisDisabled=!0,this.localSearchDisabled=!0,this.classifierRematch=!1,this.orphans=!1}handleEnqueue(){this.stage==="PENDING"&&(this.stage="REQUESTING",this.apollo.mutate({mutation:z,variables:{input:{purge:this.purge,apisDisabled:this.apisDisabled,localSearchDisabled:this.localSearchDisabled,classifierRematch:this.classifierRematch,contentTypes:this.contentTypes,orphans:this.orphans?!0:void 0}}}).subscribe(()=>{this.stage="DONE",this.data.onEnqueued?.()}))}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=D({type:n,selectors:[["app-queue-enqueue-reprocess-torrents-batch-dialog"]],standalone:!0,features:[k],decls:1,vars:0,consts:[[4,"transloco"],["mat-dialog-title",""],["mat-stroked-button","","color","warning",3,"click","disabled"],["mat-stroked-button","",3,"click"],[3,"change","checked"]],template:function(t,i){t&1&&f(0,pe,13,5,"ng-container",0)},dependencies:[Q,P,q,M,N,y,V,R,T],styles:["mat-dialog-content[_ngcontent-%COMP%]{min-height:240px;overflow:visible}mat-grid-tile[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]{width:100%;height:100%}"]})}}return n})();function de(n,u){if(n&1){let e=x();s(0,"mat-checkbox",6),p("change",function(i){m(e);let l=a(3);return _(l.handleQueueEvent(i))}),c(1),r()}if(n&2){let e=u.$implicit,t=a(3);g("value",e)("checked",t.queues==null?null:t.queues.includes(e)),o(),d(e)}}function ge(n,u){if(n&1){let e=x();s(0,"mat-checkbox",6),p("change",function(i){m(e);let l=a(3);return _(l.handleStatusEvent(i))}),c(1),r()}if(n&2){let e=u.$implicit,t=a(2).$implicit,i=a();g("value",e)("checked",i.statuses==null?null:i.statuses.includes(e)),o(),d(t("general.status"))}}function he(n,u){if(n&1){let e=x();s(0,"section")(1,"h4"),c(2),r(),s(3,"mat-checkbox",4),p("change",function(i){m(e);let l=a(2);return _(l.handleQueueEvent(i))}),c(4),r(),O(5,de,2,3,"mat-checkbox",5,B),r(),s(7,"section")(8,"h4"),c(9),r(),s(10,"mat-checkbox",4),p("change",function(i){m(e);let l=a(2);return _(l.handleStatusEvent(i))}),c(11),r(),O(12,ge,2,3,"mat-checkbox",5,B),r()}if(n&2){let e=a().$implicit,t=a();o(2),C("",e("dashboard.queues.queues"),":"),o(),g("checked",t.queues===void 0),o(),d(e("general.all")),o(),G(t.availableQueueNames),o(4),C("",e("general.status"),":"),o(),g("checked",t.statuses===void 0),o(),d(e("general.all")),o(),G(t.statusNames)}}function xe(n,u){n&1&&h(0,"mat-spinner")}function fe(n,u){if(n&1&&(s(0,"p"),c(1),r()),n&2){let e=a(2).$implicit,t=a();o(),U("",e("general.error"),": ",t.error.message,"")}}function Ce(n,u){if(n&1&&(s(0,"p"),c(1),r()),n&2){let e=a(2).$implicit;o(),d(e("dashboard.queues.queue_purged"))}}function be(n,u){if(n&1&&f(0,fe,2,2,"p")(1,Ce,2,1,"p"),n&2){let e=a(2);w(e.error?0:1)}}function De(n,u){if(n&1){let e=x();E(0),s(1,"mat-card")(2,"h2",1),c(3),r(),s(4,"mat-dialog-content"),f(5,he,14,6)(6,xe,1,0,"mat-spinner")(7,be,2,1),r(),s(8,"mat-dialog-actions")(9,"button",2),p("click",function(){m(e);let i=a();return _(i.handlePurgeJobs())}),c(10),r(),s(11,"button",3),p("click",function(){m(e);let i=a();return _(i.dialogRef.close())}),c(12),r()()(),v()}if(n&2){let e=u.$implicit,t=a();o(3),d(e("dashboard.queues.purge_queue_jobs")),o(2),w(t.stage==="PENDING"?5:t.stage==="REQUESTING"?6:t.stage==="DONE"?7:-1),o(4),g("disabled",t.stage!=="PENDING"),o(),C(" ",e("dashboard.queues.purge_jobs")," "),o(2),C(" ",e("general.dismiss")," ")}}var ae=(()=>{class n{constructor(){this.apollo=b(S),this.dialogRef=b(I),this.availableQueueNames=A,this.statusNames=J,this.stage="PENDING"}handleQueueEvent(e){if(e.source.value==="_all"){this.queues=void 0;return}if(e.checked){let t=this.queues??[];t.includes(e.source.value)||(t=[...t,e.source.value]),t.length===this.availableQueueNames.length?(e.source.checked=!1,this.queues=void 0):this.queues=t}else{let t=this.queues?.filter(i=>i!==e.source.value);t?.length?this.queues=t:this.queues=void 0}}handleStatusEvent(e){if(e.source.value==="_all"){this.statuses=void 0;return}if(e.checked){let t=this.statuses??[];t.includes(e.source.value)||(t=[...t,e.source.value]),t.length===this.statusNames.length?(e.source.checked=!1,this.statuses=void 0):this.statuses=t}else{let t=this.statuses?.filter(i=>i!==e.source.value);t?.length?this.statuses=t:this.statuses=void 0}}handlePurgeJobs(){this.stage==="PENDING"&&(this.stage="REQUESTING",this.apollo.mutate({mutation:H,variables:{input:{queues:this.queues,statuses:this.statuses}}}).pipe($(e=>(this.stage="DONE",this.error=e,j)),F(()=>{this.stage="DONE",this.data?.onPurged?.()})).subscribe())}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=D({type:n,selectors:[["app-queue-purge-jobs-dialog"]],standalone:!0,features:[k],decls:1,vars:0,consts:[[4,"transloco"],["mat-dialog-title",""],["mat-stroked-button","","color","warning",3,"click","disabled"],["mat-stroked-button","",3,"click"],["value","_all",3,"change","checked"],[3,"value","checked"],[3,"change","value","checked"]],template:function(t,i){t&1&&f(0,De,13,5,"ng-container",0)},dependencies:[Q,P,q,M,N,y,V,R,T,K],styles:["mat-dialog-content[_ngcontent-%COMP%]{min-height:240px;overflow:visible}mat-grid-tile[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]{width:100%;height:100%}"]})}}return n})();var Ee=(n,u,e)=>[n,u,e];function ve(n,u){if(n&1){let e=x();E(0),h(1,"app-document-title",1),s(2,"mat-card")(3,"mat-card-content")(4,"ul")(5,"li")(6,"a",2),p("click",function(){m(e);let i=a();return _(i.openDialogPurgeJobs())}),c(7),r()(),s(8,"li")(9,"a",2),p("click",function(){m(e);let i=a();return _(i.openDialogEnqueueReprocessTorrentsBatch())}),c(10),r()()()()(),v()}if(n&2){let e=u.$implicit;o(),g("parts",L(3,Ee,e("routes.admin"),e("routes.queues"),e("routes.dashboard"))),o(6),d(e("dashboard.queues.purge_queue_jobs")),o(3),d(e("dashboard.queues.enqueue_torrent_processing_batch"))}}var Xe=(()=>{class n{constructor(){this.dialog=b(X)}openDialogPurgeJobs(){this.dialog.open(ae)}openDialogEnqueueReprocessTorrentsBatch(){this.dialog.open(oe)}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=D({type:n,selectors:[["app-queue-admin"]],standalone:!0,features:[k],decls:1,vars:0,consts:[[4,"transloco"],[3,"parts"],["mat-button","",3,"click"]],template:function(t,i){t&1&&f(0,ve,11,7,"ng-container",0)},dependencies:[Q,Y,q,W,T,Z],styles:["ul[_ngcontent-%COMP%]{list-style-type:none;padding-left:0}ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:6px}"]})}}return n})();export{Xe as QueueAdminComponent};
