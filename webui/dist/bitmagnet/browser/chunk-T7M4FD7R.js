import{b as ye,c as we}from"./chunk-GGOWWLDY.js";import{a as j}from"./chunk-EQNSMMUR.js";import{a as Ee}from"./chunk-QR7MAH7E.js";import{$ as Zt,$a as he,B as st,Fa as L,Ka as ce,Na as dt,O as Kt,Sa as pe,Ta as me,U as Qt,Ua as de,Va as _e,Wa as ue,X as ct,Xa as fe,Ya as ge,Z as Ut,Za as xe,_a as Ce,a as V,aa as Xt,ab as Te,b as R,ba as Wt,bb as be,ca as Q,cb as ve,db as Se,ea as pt,ga as mt,h as lt,hb as z,ja as te,k as Ht,ka as ee,l as qt,la as ne,m as Yt,ma as ie,na as oe,o as Gt,oa as re,pa as ae,qa as le,ya as se,z as Jt}from"./chunk-HFKQOR7T.js";import{l as Lt}from"./chunk-WWUTX2BO.js";import{$b as c,Ac as rt,B as X,Cb as _,Ea as v,Fa as S,Hb as h,Mb as u,N as K,Na as q,Nb as tt,Ob as B,Pb as O,Q as ot,Qb as s,Rb as a,Sb as M,Tb as y,Ub as E,Wb as k,Zb as w,a as g,b as x,dd as Vt,ed as at,ha as W,hb as Rt,jc as Tt,kb as o,kc as l,l as I,lc as f,mc as m,md as jt,nc as zt,o as J,qa as b,sc as P,ua as D,uc as bt,vc as Nt,xa as At,yc as $,zc as A}from"./chunk-PHIAEVDB.js";var Ue=(t,n)=>n.id;function Ze(t,n){if(t&1&&(s(0,"mat-chip",1)(1,"mat-icon",2),l(2,"sell"),a(),l(3),a()),t&2){let e=n.$implicit;o(3),m(" ",e," ")}}function Xe(t,n){if(t&1&&l(0),t&2){let e=n.$implicit,i=n.$index,r=c(),p=c().$implicit;m(" ",p("languages."+e.id)+(i<r.length-1?", ":"")," ")}}function We(t,n){t&1&&(s(0,"mat-chip")(1,"mat-icon",2),l(2,"translate"),a(),B(3,Xe,1,1,null,null,Ue),a()),t&2&&(o(3),O(n))}function tn(t,n){t&1&&(s(0,"mat-chip"),l(1),a()),t&2&&(o(),f(n))}function en(t,n){t&1&&(s(0,"mat-chip")(1,"mat-icon",2),l(2,"aspect_ratio"),a(),l(3),a()),t&2&&(o(3),f(n))}function nn(t,n){t&1&&(s(0,"mat-chip")(1,"mat-icon",2),l(2,"album"),a(),l(3),a()),t&2&&(o(3),f(n))}function on(t,n){t&1&&(s(0,"mat-chip"),M(1,"mat-icon",3),l(2),a()),t&2&&(o(2),f(n))}function rn(t,n){t&1&&(s(0,"mat-chip"),l(1),a()),t&2&&(o(),f(n))}function an(t,n){if(t&1&&(y(0),s(1,"mat-chip-set"),B(2,Ze,4,1,"mat-chip",1,tt),_(4,We,5,0,"mat-chip")(5,tn,2,1,"mat-chip")(6,en,4,1,"mat-chip")(7,nn,4,1,"mat-chip")(8,on,3,1,"mat-chip")(9,rn,2,1,"mat-chip"),a(),E()),t&2){let e,i,r,p,d,Y,F=c();o(2),O(F.torrentContent.torrent.tagNames),o(2),u((e=F.torrentContent.languages)?4:-1,e),o(),u((i=F.torrentContent.video3d==null?null:F.torrentContent.video3d.slice(1))?5:-1,i),o(),u((r=F.torrentContent.videoResolution==null?null:F.torrentContent.videoResolution.slice(1))?6:-1,r),o(),u((p=F.torrentContent.videoSource)?7:-1,p),o(),u((d=F.torrentContent.videoCodec)?8:-1,d),o(),u((Y=F.torrentContent.videoModifier)?9:-1,Y)}}var Vi=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=D({type:t,selectors:[["app-torrent-chips"]],inputs:{torrentContent:"torrentContent"},standalone:!0,features:[P],decls:1,vars:0,consts:[[4,"transloco"],[1,"chip-primary"],["matChipAvatar",""],["matChipAvatar","","svgIcon","binary"]],template:function(i,r){i&1&&_(0,an,10,6,"ng-container",0)},dependencies:[z,ne,te,oe,L,R],styles:["mat-chip-set[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{position:relative;left:4px}"]})}}return t})();var Et=["files","tags","reprocess","delete"],ln=(t,n)=>t&&n?t.infoHash===n.infoHash&&t.tab===n.tab:t===n,Ie=t=>({input:{queryString:t.queryString,limit:t.limit,page:t.page,totalCount:!0,hasNextPage:!0,orderBy:[t.orderBy],aggregationBudget:t.aggregationBudget,facets:{contentType:{aggregate:!0,filter:t.contentType?[t.contentType==="null"?null:t.contentType]:void 0},genre:t.facets.genre.active?{aggregate:!0,filter:t.facets.genre.filter}:void 0,language:t.facets.language.active?{aggregate:t.facets.language.active,filter:t.facets.language.filter}:void 0,torrentFileType:t.facets.fileType.active?{aggregate:!0,filter:t.facets.fileType.filter}:void 0,torrentSource:t.facets.torrentSource.active?{aggregate:!0,filter:t.facets.torrentSource.filter}:void 0,torrentTag:t.facets.torrentTag.active?{aggregate:!0,filter:t.facets.torrentTag.filter}:void 0,videoResolution:t.facets.videoResolution.active?{aggregate:!0,filter:t.facets.videoResolution.filter}:void 0,videoSource:t.facets.videoSource.active?{aggregate:!0,filter:t.facets.videoSource.filter}:void 0}}}),St={active:!1},Me=class{constructor(n){this.controlsSubject=new I(n),this.controls$=this.controlsSubject.asObservable(),this.paramsSubject=new I(Ie(n)),this.params$=this.paramsSubject.asObservable(),this.selectionSubject=new I(n.selectedTorrent),this.selection$=this.selectionSubject.asObservable(),this.controls$.pipe(ot(100)).subscribe(e=>{let i=Ie(e);JSON.stringify(this.paramsSubject.getValue())!==JSON.stringify(i)&&this.paramsSubject.next(i),ln(this.selectionSubject.getValue(),e.selectedTorrent)||this.selectionSubject.next(e.selectedTorrent)})}update(n){let e=this.controlsSubject.getValue(),i=n(e);JSON.stringify(e)!==JSON.stringify(i)&&this.controlsSubject.next(i)}selectTorrent(n,e){this.update(i=>(e===void 0?e=i.selectedTorrent?.tab:e===null&&(e=void 0),x(g({},i),{selectedTorrent:{infoHash:n,tab:e}})))}selectContentType(n){this.update(e=>x(g({},e),{contentType:n,page:1,facets:x(g({},e.facets),{genre:yt(n,$e.contentTypes)?e.facets.genre:St,videoResolution:yt(n,Fe.contentTypes)?e.facets.videoResolution:St,videoSource:yt(n,De.contentTypes)?e.facets.videoSource:St})}))}activateFacet(n){this.update(e=>x(g({},e),{facets:n.patchInput(e.facets,x(g({},n.extractInput(e.facets)),{active:!0}))}))}deactivateFacet(n){this.update(e=>{let i=n.extractInput(e.facets);return x(g({},e),{page:i.filter?1:e.page,facets:n.patchInput(e.facets,x(g({},i),{active:!1,filter:void 0}))})})}activateFilter(n,e){this.update(i=>{let r=n.extractInput(i.facets);return x(g({},i),{page:1,facets:n.patchInput(i.facets,x(g({},r),{filter:Array.from(new Set([...r.filter??[],e])).sort()}))})})}deactivateFilter(n,e){this.update(i=>{let r=n.extractInput(i.facets),p=r.filter?.filter(d=>d!==e);return x(g({},i),{page:1,facets:n.patchInput(i.facets,x(g({},r),{filter:p?.length?p:void 0}))})})}setQueryString(n){n=n||void 0,this.update(e=>{let i=e.orderBy;return n?n!==e.queryString&&(i=_n):i.field==="relevance"&&(i=ke),x(g({},e),{queryString:n,orderBy:i,page:n===e.queryString?e.page:1})})}selectOrderBy(n){let e={field:n,descending:dn.find(i=>i.field===n)?.descending??!1};this.update(i=>x(g({},i),{orderBy:e.field!=="relevance"||i.queryString?e:ke,page:1}))}toggleOrderByDirection(){this.update(n=>x(g({},n),{orderBy:x(g({},n.orderBy),{descending:!n.orderBy.descending}),page:1}))}handlePageEvent(n){this.update(e=>x(g({},e),{limit:n.pageSize,page:n.page}))}},sn={key:"torrent_source",icon:"mediation",allowNull:!1,extractInput:t=>t.torrentSource,patchInput:(t,n)=>x(g({},t),{torrentSource:n}),extractAggregations:t=>t.torrentSource??[],resolveLabel:t=>t.label},cn={key:"torrent_tag",icon:"sell",allowNull:!1,extractInput:t=>t.torrentTag,patchInput:(t,n)=>x(g({},t),{torrentTag:n}),extractAggregations:t=>t.torrentTag??[],resolveLabel:t=>t.value},pn={key:"file_type",icon:"file_present",allowNull:!1,extractInput:t=>t.fileType,patchInput:(t,n)=>x(g({},t),{fileType:n}),extractAggregations:t=>t.torrentFileType??[],resolveLabel:(t,n)=>n.translate(`file_types.${t.value}`)},mn={key:"language",icon:"translate",allowNull:!1,extractInput:t=>t.language,patchInput:(t,n)=>x(g({},t),{language:n}),extractAggregations:t=>t.language??[],resolveLabel:(t,n)=>n.translate(`languages.${t.value}`)},$e={key:"genre",icon:"theater_comedy",allowNull:!1,contentTypes:["movie","tv_show"],extractInput:t=>t.genre,patchInput:(t,n)=>x(g({},t),{genre:n}),extractAggregations:t=>t.genre??[],resolveLabel:t=>t.label},Fe={key:"video_resolution",icon:"aspect_ratio",allowNull:!0,contentTypes:["movie","tv_show","xxx"],extractInput:t=>t.videoResolution,patchInput:(t,n)=>x(g({},t),{videoResolution:n}),extractAggregations:t=>(t.videoResolution??[]).map(n=>x(g({},n),{value:n.value??null})),resolveLabel:t=>t.value?.slice(1)??"?"},De={key:"video_source",icon:"album",allowNull:!0,contentTypes:["movie","tv_show","xxx"],extractInput:t=>t.videoSource,patchInput:(t,n)=>x(g({},t),{videoSource:n}),extractAggregations:t=>(t.videoSource??[]).map(n=>x(g({},n),{value:n.value??null})),resolveLabel:t=>t.value??"?"},Hi=[sn,cn,pn,mn,$e,Fe,De],dn=[{field:"relevance",descending:!0},{field:"published_at",descending:!0},{field:"updated_at",descending:!0},{field:"size",descending:!0},{field:"files_count",descending:!0},{field:"seeders",descending:!0},{field:"leechers",descending:!0},{field:"name",descending:!1}],ke={field:"published_at",descending:!0},_n={field:"relevance",descending:!0},yt=(t,n)=>!n||t&&n.includes(t),qi=t=>t.orderBy.descending?t.orderBy.field===(t.queryString?"relevance":"published_at"):!1;var un="array",fn="bit",Be="bits",gn="byte",Oe="bytes",U="",xn="exponent",Cn="function",Pe="iec",hn="Invalid number",Tn="Invalid rounding method",wt="jedec",bn="object",Ae=".",vn="round",Sn="s",yn="si",En="kbit",wn="kB",In=" ",Mn="string",kn="0",It={symbol:{iec:{bits:["bit","Kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],bytes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},jedec:{bits:["bit","Kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],bytes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]}},fullform:{iec:["","kibi","mebi","gibi","tebi","pebi","exbi","zebi","yobi"],jedec:["","kilo","mega","giga","tera","peta","exa","zetta","yotta"]}};function Re(t,{bits:n=!1,pad:e=!1,base:i=-1,round:r=2,locale:p=U,localeOptions:d={},separator:Y=U,spacer:F=In,symbols:qe={},standard:N=U,output:Ct=Mn,fullform:Ye=!1,fullforms:Mt=[],exponent:kt=-1,roundingMethod:Ge=vn,precision:nt=0}={}){let T=kt,G=Number(t),C=[],H=0,ht=U;N===yn?(i=10,N=wt):N===Pe||N===wt?i=2:i===2?N=Pe:(i=10,N=wt);let it=i===10?1e3:1024,Je=Ye===!0,$t=G<0,Ft=Math[Ge];if(typeof t!="bigint"&&isNaN(t))throw new TypeError(hn);if(typeof Ft!==Cn)throw new TypeError(Tn);if($t&&(G=-G),(T===-1||isNaN(T))&&(T=Math.floor(Math.log(G)/Math.log(it)),T<0&&(T=0)),T>8&&(nt>0&&(nt+=8-T),T=8),Ct===xn)return T;if(G===0)C[0]=0,ht=C[1]=It.symbol[N][n?Be:Oe][T];else{H=G/(i===2?Math.pow(2,T*10):Math.pow(1e3,T)),n&&(H=H*8,H>=it&&T<8&&(H=H/it,T++));let Z=Math.pow(10,T>0?r:0);C[0]=Ft(H*Z)/Z,C[0]===it&&T<8&&kt===-1&&(C[0]=1,T++),ht=C[1]=i===10&&T===1?n?En:wn:It.symbol[N][n?Be:Oe][T]}if($t&&(C[0]=-C[0]),nt>0&&(C[0]=C[0].toPrecision(nt)),C[1]=qe[C[1]]||C[1],p===!0?C[0]=C[0].toLocaleString():p.length>0?C[0]=C[0].toLocaleString(p,d):Y.length>0&&(C[0]=C[0].toString().replace(Ae,Y)),e&&r>0){let Z=C[0].toString(),Dt=Y||(Z.match(/(\D)/g)||[]).pop()||Ae,Bt=Z.toString().split(Dt),Ot=Bt[1]||U,Pt=Ot.length,Ke=r-Pt;C[0]=`${Bt[0]}${Dt}${Ot.padEnd(Pt+Ke,kn)}`}return Je&&(C[1]=Mt[T]?Mt[T]:It.fullform[N][T]+(n?fn:gn)+(C[0]===1?U:Sn)),Ct===un?C:Ct===bn?{value:C[0],symbol:C[1],exponent:T,unit:ht}:C.join(F)}var ut=(()=>{class t{constructor(){this.transloco=b(V)}transform(e,i=2){return Re(e,{locale:this.transloco.getActiveLang(),base:i})}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275pipe=At({name:"filesize",type:t,pure:!1,standalone:!0})}}return t})();var Fn={items:[],hasNextPage:!1,totalCount:0,aggregations:{queue:[],status:[]}},ft=class{constructor(n,e,i){this.apollo=n,this.errorsService=e,this.currentRequest=new I(0),this.loadingSubject=new I(!1),this.loading$=this.loadingSubject.asObservable(),this.result=Fn,this.resultSubject=new I(this.result),this.result$=this.resultSubject.asObservable(),this.items$=this.resultSubject.pipe(X(r=>r.items)),i.subscribe(r=>{this.loadResult(r)}),this.resultSubject.subscribe(r=>{this.result=r})}connect({}){return this.items$}disconnect(){this.resultSubject.complete()}loadResult(n){this.currentSubscription&&(this.currentSubscription.unsubscribe(),this.currentSubscription=void 0),this.loadingSubject.next(!0);let e=this.currentRequest.getValue()+1;this.currentRequest.next(e);let i=this.apollo.query({query:Qt,variables:n,fetchPolicy:"no-cache"}).pipe(X(r=>r.data.torrent.files)).pipe(K(r=>(this.errorsService.addError(`Error loading item results: ${r.message}`),J)));this.currentSubscription=i.subscribe(r=>{e===this.currentRequest.getValue()&&(this.loadingSubject.next(!1),this.resultSubject.next(r))})}},gt=class{constructor(n){this.torrent=n,this.loading$=new I(!1).asObservable(),this.file={infoHash:n.infoHash,index:0,path:n.name,size:n.size,fileType:n.fileType,extension:n.extension,createdAt:n.createdAt,updatedAt:n.updatedAt},this.result={hasNextPage:!1,items:[this.file],totalCount:1},this.result$=new I(this.result).asObservable(),this.items$=new I([this.file]).asObservable()}connect({}){return this.items$}disconnect(){}};var xt=class{constructor(n){let e={infoHash:n,limit:10,page:1};this.controlsSubject=new I(e),this.controls$=this.controlsSubject.asObservable(),this.controls$.pipe(ot(100)).subscribe(i=>{let r=this.variablesSubject.getValue(),p=ze(i);JSON.stringify(r)!==JSON.stringify(p)&&this.variablesSubject.next(p)}),this.variablesSubject=new I(ze(e)),this.variables$=this.variablesSubject.asObservable()}update(n){let e=this.controlsSubject.getValue(),i=n(e);JSON.stringify(e)!==JSON.stringify(i)&&this.controlsSubject.next(i)}handlePageEvent(n){this.update(e=>x(g({},e),{limit:n.pageSize,page:n.page}))}},ze=t=>({input:{infoHashes:[t.infoHash],limit:t.limit,page:t.page,totalCount:!0,hasNextPage:!1}});var On=(t,n)=>({x:t,y:n});function Pn(t,n){if(t&1&&(s(0,"p"),l(1),$(2,"number"),$(3,"number"),a()),t&2){let e=c().$implicit,i=c();o(),m(" ",e("torrents.showing_x_of_y_files",Nt(5,On,A(2,1,i.dataSource.result.totalCount),i.torrent.filesCount==null?"?":A(3,3,i.torrent.filesCount)))," ")}}function An(t,n){if(t&1&&(s(0,"th",13),l(1),a()),t&2){let e=c().$implicit;o(),f(e("torrents.file_index"))}}function Rn(t,n){if(t&1&&(s(0,"td",14),l(1),a()),t&2){let e=n.$implicit,i=c(2);o(),m(" ",i.item(e).index," ")}}function zn(t,n){if(t&1&&(s(0,"th",13),l(1),a()),t&2){let e=c().$implicit;o(),f(e("torrents.file_path"))}}function Nn(t,n){if(t&1&&(s(0,"td",14),l(1),a()),t&2){let e=n.$implicit,i=c(2);o(),m(" ",i.item(e).path," ")}}function Vn(t,n){if(t&1&&(s(0,"th",13),l(1),a()),t&2){let e=c().$implicit;o(),f(e("torrents.file_type"))}}function jn(t,n){if(t&1&&(s(0,"td",14),l(1),a()),t&2){let e,i=n.$implicit,r=c().$implicit,p=c();o(),m(" ",r("file_types."+((e=p.item(i).fileType)!==null&&e!==void 0?e:"unknown"))," ")}}function Ln(t,n){if(t&1&&(s(0,"th",13),l(1),a()),t&2){let e=c().$implicit;o(),f(e("torrents.file_size"))}}function Hn(t,n){if(t&1&&(s(0,"td",14)(1,"span",15),$(2,"filesize"),l(3),$(4,"filesize"),a()()),t&2){let e=n.$implicit,i=c(2);o(),h("matTooltip",rt(2,2,i.item(e).size,10)),o(2),f(A(4,5,i.item(e).size))}}function qn(t,n){t&1&&M(0,"tr",16)}function Yn(t,n){t&1&&M(0,"tr",17)}function Gn(t,n){if(t&1){let e=k();s(0,"app-paginator",18),w("paging",function(r){v(e);let p=c(2);return S(p.controller.handlePageEvent(r))}),a()}if(t&2){let e=c(2);h("page",e.controls.page)("pageSize",e.controls.limit)("pageLength",e.dataSource.result.items.length)("totalLength",e.dataSource.result.totalCount)("totalIsEstimate",!1)("showLastPage",!0)}}function Jn(t,n){if(t&1&&(y(0),s(1,"div",1),M(2,"mat-progress-bar",2),$(3,"async"),a(),_(4,Pn,4,8,"p"),s(5,"table",3),y(6,4),_(7,An,2,1,"th",5)(8,Rn,2,1,"td",6),E(),y(9,7),_(10,zn,2,1,"th",5)(11,Nn,2,1,"td",6),E(),y(12,8),_(13,Vn,2,1,"th",5)(14,jn,2,1,"td",6),E(),y(15,9),_(16,Ln,2,1,"th",5)(17,Hn,5,7,"td",6),E(),_(18,qn,1,0,"tr",10)(19,Yn,1,0,"tr",11),a(),_(20,Gn,1,6,"app-paginator",12),E()),t&2){let e=c();o(2),h("mode",A(3,8,e.dataSource.loading$)?"indeterminate":"determinate")("value",0),o(2),u(e.torrent.filesStatus==="over_threshold"?4:-1),o(),h("dataSource",e.dataSource)("multiTemplateDataRows",!0),o(13),h("matHeaderRowDef",e.displayedColumns),o(),h("matRowDefColumns",e.displayedColumns),o(),u(e.dataSource.result.totalCount>10?20:-1)}}var Ne=(()=>{class t{constructor(){this.apollo=b(lt),this.errorsService=b(j),this.transloco=b(V),this.displayedColumns=["index","path","type","size"]}ngOnInit(){this.controller=new xt(this.torrent.infoHash),this.dataSource=this.torrent.filesStatus==="single"?new gt(this.torrent):new ft(this.apollo,this.errorsService,this.controller.variables$),this.controller.controls$.subscribe(e=>{this.controls=e})}item(e){return e}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=D({type:t,selectors:[["app-torrent-files-table"]],inputs:{torrent:"torrent"},standalone:!0,features:[P],decls:1,vars:0,consts:[[4,"transloco"],[1,"progress-bar-container"],[3,"mode","value"],["mat-table","",1,"table-results",3,"dataSource","multiTemplateDataRows"],["matColumnDef","index"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","path"],["matColumnDef","type"],["matColumnDef","size"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"page","pageSize","pageLength","totalLength","totalIsEstimate","showLastPage"],["mat-header-cell",""],["mat-cell",""],[1,"filesize",3,"matTooltip"],["mat-header-row",""],["mat-row",""],[3,"paging","page","pageSize","pageLength","totalLength","totalIsEstimate","showLastPage"]],template:function(i,r){i&1&&_(0,Jn,21,10,"ng-container",0)},dependencies:[z,ce,pe,de,ge,_e,me,xe,ue,fe,Ce,he,dt,R,Vt,at,ut,ye],styles:["span.filesize[_ngcontent-%COMP%]{text-decoration:underline;text-decoration-style:dotted}"]})}}return t})();var Kn=t=>t.toLowerCase().replaceAll(/[^a-z0-9\-]/g,"-").replace(/^-+/,"").replaceAll(/-+/g,"-"),Ve=Kn;function Qn(t,n){if(t&1){let e=k();s(0,"mat-chip-row",8),w("edited",function(r){let p=v(e).$implicit,d=c(2);return S(d.renameTag(p,r.value))})("removed",function(){let r=v(e).$implicit,p=c(2);return S(p.deleteTag(r))}),l(1),s(2,"mat-icon",9),l(3,"cancel"),a()()}if(t&2){let e=n.$implicit;h("editable",!0),o(),m(" ",e," ")}}function Un(t,n){if(t&1&&(s(0,"mat-option",7),l(1),a()),t&2){let e=n.$implicit;h("value",e),o(),f(e)}}function Zn(t,n){if(t&1){let e=k();y(0),s(1,"mat-card")(2,"mat-form-field",3)(3,"mat-chip-grid",null,0),B(5,Qn,4,2,"mat-chip-row",4,tt),a(),s(7,"input",5),w("matChipInputTokenEnd",function(r){v(e);let p=c();return S(r.value&&p.addTag(r.value))}),a(),s(8,"mat-autocomplete",6,1),w("optionSelected",function(r){v(e);let p=c();return S(p.addTag(r.option.viewValue))}),B(10,Un,2,2,"mat-option",7,tt),a()()(),E()}if(t&2){let e=n.$implicit,i=Tt(4),r=Tt(9),p=c();o(5),O(p.editedTags),o(2),h("placeholder",e("torrents.new_tag"))("formControl",p.newTagCtrl)("matAutocomplete",r)("matChipInputFor",i)("matChipInputSeparatorKeyCodes",p.separatorKeysCodes)("value",p.newTagCtrl.value),o(3),O(p.suggestedTags)}}var Le=(()=>{class t{constructor(){this.newTagCtrl=new Yt(""),this.editedTags=Array(),this.suggestedTags=Array(),this.transloco=b(V),this.grapql=b(ct),this.errors=b(j),this.separatorKeysCodes=[13,188],this.updated=new q}ngOnInit(){this.newTagCtrl.valueChanges.subscribe(e=>(e&&(e=Ve(e),this.newTagCtrl.setValue(e,{emitEvent:!1})),this.grapql.torrentSuggestTags({input:{prefix:e,exclusions:this.torrentContent.torrent.tagNames}}).pipe(W(i=>{this.suggestedTags.splice(0,this.suggestedTags.length,...i.suggestions.map(r=>r.name))})).subscribe())),this.editedTags=this.torrentContent.torrent.tagNames,this.newTagCtrl.reset()}addTag(e){this.editTags(i=>[...i,e]),this.saveTags()}renameTag(e,i){this.editTags(r=>r.map(p=>p===e?i:p)),this.saveTags()}deleteTag(e){this.editTags(i=>i.filter(r=>r!==e)),this.saveTags()}editTags(e){this.editedTags=e(this.editedTags),this.newTagCtrl.reset()}saveTags(){this.grapql.torrentSetTags({infoHashes:[this.torrentContent.infoHash],tagNames:this.editedTags}).pipe(K(e=>(this.errors.addError(`Error saving tags: ${e.message}`),J))).pipe(W(()=>{this.updated.emit(null)})).subscribe()}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=D({type:t,selectors:[["app-torrent-edit-tags"]],inputs:{torrentContent:"torrentContent"},outputs:{updated:"updated"},standalone:!0,features:[P],decls:1,vars:0,consts:[["chipGrid",""],["auto","matAutocomplete"],[4,"transloco"],["subscriptSizing","dynamic",1,"form-edit-tags"],[3,"editable"],["autocapitalize","none",3,"matChipInputTokenEnd","placeholder","formControl","matAutocomplete","matChipInputFor","matChipInputSeparatorKeyCodes","value"],[3,"optionSelected"],[3,"value"],[3,"edited","removed","editable"],["matChipRemove",""]],template:function(i,r){i&1&&_(0,Zn,12,6,"ng-container",2)},dependencies:[z,Xt,Jt,Wt,Q,re,ae,ee,ie,Zt,L,Ht,qt,Gt,R],styles:[".form-edit-tags[_ngcontent-%COMP%]     .mat-mdc-form-field-subscript-wrapper{display:none}"]})}}return t})();function Wn(t,n){if(t&1){let e=k();y(0),s(1,"mat-card")(2,"mat-card-content")(3,"mat-checkbox",1),w("change",function(r){v(e);let p=c();return p.localSearchDisabled=!r.checked,S(p.apisDisabled=r.checked?p.apisDisabled:!0)}),l(4),a(),s(5,"mat-checkbox",1),w("change",function(r){v(e);let p=c();return p.apisDisabled=!r.checked,S(p.localSearchDisabled=r.checked?!1:p.localSearchDisabled)}),l(6),a(),s(7,"mat-checkbox",1),w("change",function(r){v(e);let p=c();return S(p.classifierRematch=r.checked)}),l(8),a()(),s(9,"mat-card-actions",2)(10,"button",3),w("click",function(){v(e);let r=c();return S(r.reprocess())}),s(11,"mat-icon"),l(12,"cycle"),a(),l(13),a()()(),E()}if(t&2){let e=n.$implicit,i=c();o(3),h("checked",!i.localSearchDisabled),o(),f(e("torrents.reprocess.match_content_by_local_search")),o(),h("checked",!i.apisDisabled),o(),f(e("torrents.reprocess.match_content_by_external_api_search")),o(),h("checked",i.classifierRematch),o(),f(e("torrents.reprocess.force_rematch")),o(2),h("disabled",!i.infoHashes.length),o(3),m("",e("torrents.reprocess.reprocess")," ")}}var He=(()=>{class t{constructor(){this.apollo=b(lt),this.errors=b(j),this.classifierRematch=!1,this.apisDisabled=!0,this.localSearchDisabled=!0,this.updated=new q}reprocess(){this.apollo.mutate({mutation:Kt,variables:{input:{infoHashes:this.infoHashes,classifierRematch:this.classifierRematch,apisDisabled:this.apisDisabled,localSearchDisabled:this.localSearchDisabled}}}).pipe(X(()=>{this.updated.emit(null)})).subscribe()}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=D({type:t,selectors:[["app-torrent-reprocess"]],inputs:{infoHashes:"infoHashes"},outputs:{updated:"updated"},standalone:!0,features:[P],decls:1,vars:0,consts:[[4,"transloco"],[3,"change","checked"],[1,"button-row"],["mat-stroked-button","",3,"click","disabled"]],template:function(i,r){i&1&&_(0,Wn,14,8,"ng-container",0)},dependencies:[z,st,Q,mt,pt,le,L,R],styles:[".mat-mdc-card[_ngcontent-%COMP%]{margin-bottom:10px}mat-checkbox[_ngcontent-%COMP%]{margin-right:20px}"]})}}return t})();var ti=(t,n)=>n.key,ei=(t,n)=>n.id,ni=(t,n)=>n.metadataSource.key,ii=t=>({count:t}),oi=t=>[t];function ri(t,n){if(t&1&&M(0,"img",1),t&2){let e=c().$implicit,i=c();h("ngSrc","https://image.tmdb.org/t/p/w300/"+n)("alt",e("torrents.poster"))("width",i.breakpoints.sizeAtLeast("Medium")?300:150)("height",i.breakpoints.sizeAtLeast("Medium")?450:225)}}function ai(t,n){if(t&1&&(s(0,"h2")(1,"a",12),l(2),a()()),t&2){let e=c().$implicit,i=c();o(),h("routerLink","permalink/"+i.torrentContent.infoHash)("matTooltip",e("torrents.permalink")),o(),f(i.torrentContent.torrent.name)}}function li(t,n){if(t&1&&(s(0,"p",2)(1,"strong"),l(2),a(),l(3,"\xA0 "),s(4,"span",13),$(5,"filesize"),l(6),$(7,"filesize"),a()()),t&2){let e=c().$implicit,i=c();o(2),m("",e("torrents.size"),":"),o(2),h("matTooltip",rt(5,3,i.torrentContent.torrent.size,10)),o(2),f(A(7,6,i.torrentContent.torrent.size))}}function si(t,n){if(t&1&&(s(0,"p",3)(1,"strong"),l(2),a(),l(3),$(4,"timeAgo"),a()),t&2){let e=c().$implicit,i=c();o(2),f(e("torrents.published")),o(),m(" ",A(4,2,i.torrentContent.publishedAt)," ")}}function ci(t,n){if(t&1&&(s(0,"p",4)(1,"strong"),l(2),a(),l(3),a()),t&2){let e,i=c().$implicit,r=c();o(2),m("",i("torrents.s_l"),":"),o(),zt(" ",(e=r.torrentContent.seeders)!==null&&e!==void 0?e:"?"," / ",(e=r.torrentContent.leechers)!==null&&e!==void 0?e:"?"," ")}}function pi(t,n){if(t&1&&(s(0,"span"),l(1),a()),t&2){let e=n.$implicit,i=n.$index;o(),f((i>0?", ":"")+e.name)}}function mi(t,n){if(t&1&&(s(0,"p")(1,"strong"),l(2),a(),l(3),a()),t&2){let e=c().$implicit,i=c();o(2),m("",e("torrents.title"),":"),o(),m(" ",i.torrentContent.content.title," ")}}function di(t,n){if(t&1&&l(0),t&2){let e=n.$implicit,i=n.$index,r=c(3);m(" ",(i>0?", ":"")+e.name+(e.id===(r.torrentContent.content==null||r.torrentContent.content.originalLanguage==null?null:r.torrentContent.content.originalLanguage.id)?" (original)":"")," ")}}function _i(t,n){if(t&1&&(s(0,"p")(1,"strong"),l(2),a(),l(3,"\xA0 "),B(4,di,1,1,null,null,ei),a()),t&2){let e=c().$implicit,i=c();o(2),m("",e("torrents.languages"),":"),o(2),O(i.torrentContent.languages)}}function ui(t,n){if(t&1&&(s(0,"p")(1,"strong"),l(2),a(),l(3),a()),t&2){let e,i=c().$implicit,r=c();o(2),m("",i("torrents.original_release_date"),":"),o(),m(" ",(e=r.torrentContent.content==null?null:r.torrentContent.content.releaseDate)!==null&&e!==void 0?e:r.torrentContent.content==null?null:r.torrentContent.content.releaseYear," ")}}function fi(t,n){if(t&1&&(s(0,"p")(1,"strong"),l(2),a(),l(3),a()),t&2){let e=c().$implicit,i=c();o(2),m("",e("torrents.episodes"),":"),o(),m(" ",i.torrentContent.episodes.label," ")}}function gi(t,n){if(t&1&&(s(0,"p"),l(1),a()),t&2){let e=c(2);o(),m(" ",e.torrentContent.content.overview," ")}}function xi(t,n){if(t&1&&(y(0),s(1,"p")(2,"strong"),l(3),a(),l(4),a(),E()),t&2){let e=c().$implicit;o(3),m("",e("torrents.genres"),":"),o(),m(" ",n.join(", ")," ")}}function Ci(t,n){if(t&1&&(y(0),l(1),$(2,"number"),E()),t&2){let e=c(2).$implicit,i=c();o(),m("(",e("torrents.votes_count_n",bt(3,ii,A(2,1,i.torrentContent.content==null?null:i.torrentContent.content.voteCount))),")")}}function hi(t,n){if(t&1&&(s(0,"p")(1,"strong"),l(2),a(),l(3),_(4,Ci,3,5,"ng-container"),a()),t&2){let e=c().$implicit,i=c();o(2),m("",e("torrents.rating"),":"),o(),m(" ",i.torrentContent.content==null?null:i.torrentContent.content.voteAverage," / 10 "),o(),u((i.torrentContent.content==null?null:i.torrentContent.content.voteCount)!=null?4:-1)}}function Ti(t,n){if(t&1&&(l(0),s(1,"a",14),l(2),a()),t&2){let e=n.$implicit,i=n.$index;m(" ",i>0?", ":"",""),o(),h("href",e.url,Rt),o(),f(e.metadataSource.name)}}function bi(t,n){if(t&1&&(s(0,"p")(1,"strong"),l(2),a(),l(3,"\xA0 "),B(4,Ti,3,3,"a",14,ni),a()),t&2){let e=c().$implicit;o(2),m("",e("torrents.external_links"),":"),o(2),O(n)}}function vi(t,n){if(t&1&&(s(0,"span",15),l(1),a()),t&2){let e=c(2).$implicit;o(),f(e("torrents.files"))}}function Si(t,n){t&1&&(s(0,"span",16),l(1),$(2,"number"),a()),t&2&&(o(),m("(",A(2,1,n),")"))}function yi(t,n){if(t&1&&(s(0,"mat-icon"),l(1,"file_present"),a(),_(2,vi,2,1,"span",15)(3,Si,3,3,"span",16)),t&2){let e,i=c(2);o(2),u(i.breakpoints.sizeAtLeast("Medium")?2:-1),o(),u((e=i.filesCount())?3:-1,e)}}function Ei(t,n){if(t&1&&(s(0,"p"),l(1),a()),t&2){let e=c(2).$implicit;o(),f(e("torrents.files_no_info"))}}function wi(t,n){if(t&1&&(s(0,"mat-card",17),_(1,Ei,2,1,"p"),M(2,"app-torrent-files-table",18),a()),t&2){let e=c(2);o(),u(e.torrentContent.torrent.filesStatus==="no_info"?1:-1),o(),h("torrent",e.torrentContent.torrent)}}function Ii(t,n){if(t&1&&(s(0,"span",15),l(1),a()),t&2){let e=c(2).$implicit;o(),f(e("torrents.edit_tags"))}}function Mi(t,n){if(t&1&&(s(0,"mat-icon"),l(1,"sell"),a(),_(2,Ii,2,1,"span",15)),t&2){let e=c(2);o(2),u(e.breakpoints.sizeAtLeast("Medium")?2:-1)}}function ki(t,n){if(t&1){let e=k();s(0,"app-torrent-edit-tags",19),w("updated",function(){v(e);let r=c(2);return S(r.updated.emit(null))}),a()}if(t&2){let e=c(2);h("torrentContent",e.torrentContent)}}function $i(t,n){if(t&1&&(s(0,"span",15),l(1),a()),t&2){let e=c(2).$implicit;o(),f(e("torrents.classification"))}}function Fi(t,n){if(t&1&&(s(0,"mat-icon"),l(1,"category"),a(),_(2,$i,2,1,"span",15)),t&2){let e=c(2);o(2),u(e.breakpoints.sizeAtLeast("Medium")?2:-1)}}function Di(t,n){if(t&1){let e=k();s(0,"app-torrent-reprocess",20),w("updated",function(){v(e);let r=c(2);return S(r.updated.emit(null))}),a()}if(t&2){let e=c(2);h("infoHashes",bt(1,oi,e.torrentContent.infoHash))}}function Bi(t,n){if(t&1&&(s(0,"span",15),l(1),a()),t&2){let e=c(2).$implicit;o(),f(e("torrents.delete"))}}function Oi(t,n){if(t&1&&(s(0,"mat-icon"),l(1,"delete_forever"),a(),_(2,Bi,2,1,"span",15)),t&2){let e=c(2);o(2),u(e.breakpoints.sizeAtLeast("Medium")?2:-1)}}function Pi(t,n){if(t&1){let e=k();s(0,"mat-card")(1,"mat-card-content",21)(2,"p")(3,"strong"),l(4),a(),M(5,"br"),l(6),a()(),s(7,"mat-card-actions",22)(8,"button",23),w("click",function(){v(e);let r=c(2);return S(r.delete())}),s(9,"mat-icon"),l(10,"delete_forever"),a(),l(11),a()()()}if(t&2){let e=c().$implicit;o(4),f(e("torrents.delete_are_you_sure")),o(2),m("",e("torrents.delete_action_cannot_be_undone")," "),o(5),m("",e("torrents.delete")," ")}}function Ai(t,n){t&1&&(s(0,"mat-icon",24),l(1,"close"),a())}function Ri(t,n){t&1&&(s(0,"mat-tab"),_(1,Ai,2,0,"ng-template",10),a())}function zi(t,n){if(t&1){let e=k();y(0),_(1,ri,1,4,"img",1)(2,ai,3,3,"h2")(3,li,8,8,"p",2)(4,si,5,4,"p",3)(5,ci,4,3,"p",4),s(6,"p",5)(7,"strong"),l(8),a(),s(9,"span",6),l(10),a()(),s(11,"p")(12,"strong"),l(13),a(),l(14,"\xA0 "),B(15,pi,2,1,"span",null,ti),a(),_(17,mi,4,2,"p")(18,_i,6,1,"p")(19,ui,4,2,"p")(20,fi,4,2,"p")(21,gi,2,1,"p")(22,xi,5,2,"ng-container")(23,hi,5,3,"p")(24,bi,6,1,"p"),M(25,"mat-divider",7),s(26,"mat-tab-group",8),w("focusChange",function(r){v(e);let p=c();return S(p.selectTabIndex(r.index))}),M(27,"mat-tab",9),s(28,"mat-tab"),_(29,yi,4,2,"ng-template",10)(30,wi,3,2,"ng-template",11),a(),s(31,"mat-tab"),_(32,Mi,3,1,"ng-template",10)(33,ki,1,1,"ng-template",11),a(),s(34,"mat-tab"),_(35,Fi,3,1,"ng-template",10)(36,Di,1,3,"ng-template",11),a(),s(37,"mat-tab"),_(38,Oi,3,1,"ng-template",10)(39,Pi,12,3,"ng-template",11),a(),_(40,Ri,2,0,"mat-tab"),a(),E()}if(t&2){let e,i,r,p=n.$implicit,d=c();o(),u((e=d.getAttribute("poster_path","tmdb"))?1:-1,e),o(),u(d.heading?2:-1),o(),u(d.size?3:-1),o(),u(d.published?4:-1),o(),u(d.peers?5:-1),o(3),m("",p("torrents.info_hash"),":"),o(),h("matTooltip",p("torrents.copy_to_clipboard"))("cdkCopyToClipboard",d.torrentContent.infoHash),o(),f(d.torrentContent.infoHash),o(3),m("",p("torrents.source"),":"),o(2),O(d.torrentContent.torrent.sources),o(2),u(d.torrentContent.content?17:-1),o(),u(d.torrentContent.languages!=null&&d.torrentContent.languages.length?18:-1),o(),u(d.torrentContent.content!=null&&d.torrentContent.content.releaseYear?19:-1),o(),u(d.torrentContent.episodes?20:-1),o(),u(d.torrentContent.content!=null&&d.torrentContent.content.overview?21:-1),o(),u((i=d.getCollections("genre"))?22:-1,i),o(),u((d.torrentContent.content==null?null:d.torrentContent.content.voteAverage)!=null?23:-1),o(),u((r=d.torrentContent.content==null?null:d.torrentContent.content.externalLinks)?24:-1,r),o(2),h("selectedIndex",d.selectedTabIndex)("mat-stretch-tabs",!1),o(14),u(d.selectedTabIndex>0?40:-1)}}var Cr=(()=>{class t{constructor(){this.breakpoints=b(Ee),this.heading=!0,this.size=!0,this.peers=!0,this.published=!0,this.updated=new q,this.tabSelected=new q,this.selectedTab=void 0,this.transloco=b(V),this.grapql=b(ct),this.errors=b(j)}get selectedTabIndex(){return Et.indexOf(this.selectedTab)+1}selectTabIndex(e){this.selectedTab=Et[e-1],this.tabSelected.emit(this.selectedTab)}delete(){this.grapql.torrentDelete({infoHashes:[this.torrentContent.infoHash]}).pipe(K(e=>(this.errors.addError(`Error deleting torrent: ${e.message}`),J))).pipe(W(()=>{this.updated.emit(null)})).subscribe()}getAttribute(e,i){return this.torrentContent.content?.attributes?.find(r=>r.key===e&&(i===void 0||r.source===i))?.value}getCollections(e){let i=this.torrentContent.content?.collections?.filter(r=>r.type===e).map(r=>r.name);return i?.length?i.sort():void 0}filesCount(){return this.torrentContent.torrent.filesStatus==="single"?1:this.torrentContent.torrent.filesCount??void 0}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=D({type:t,selectors:[["app-torrent-content"]],inputs:{torrentContent:"torrentContent",heading:"heading",size:"size",peers:"peers",published:"published",selectedTab:"selectedTab"},outputs:{updated:"updated",tabSelected:"tabSelected"},standalone:!0,features:[P],decls:1,vars:0,consts:[[4,"transloco"],[1,"poster",3,"ngSrc","alt","width","height"],[1,"size"],[1,"published"],[1,"peers"],[1,"info-hash"],[3,"matTooltip","cdkCopyToClipboard"],[2,"clear","both"],["animationDuration","0",3,"focusChange","selectedIndex","mat-stretch-tabs"],["aria-labelledby","hidden"],["mat-tab-label",""],["matTabContent",""],[3,"routerLink","matTooltip"],[1,"filesize",3,"matTooltip"],["target","_blank",3,"href"],[1,"label"],[1,"files-count"],[1,"torrent-files"],[3,"torrent"],[3,"updated","torrentContent"],[3,"updated","infoHashes"],[2,"margin-top","10px"],[1,"button-row"],["mat-stroked-button","","color","warning",3,"click"],[2,"margin-right","0"]],template:function(i,r){i&1&&_(0,zi,41,21,"ng-container",0)},dependencies:[z,Ut,st,Q,mt,pt,se,L,Te,be,ve,Se,dt,Lt,R,at,ut,jt,we,Le,Ne,He],styles:["h2[_ngcontent-%COMP%]{margin-top:10px;max-width:900px;white-space:pre-wrap;word-break:break-all;overflow-wrap:break-word}.poster[_ngcontent-%COMP%]{float:right;margin:10px;border:1px solid currentColor}.info-hash[_ngcontent-%COMP%]{white-space:pre-wrap;word-break:break-all;overflow-wrap:break-word}.info-hash[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding-left:5px;cursor:crosshair;text-decoration:underline;text-decoration-style:dotted}.torrent-files[_ngcontent-%COMP%]{padding-top:10px;max-height:800px;overflow:scroll;scrollbar-width:none}.torrent-files[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{margin-bottom:10px;width:800px}.torrent-files[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding-right:20px;border-bottom:1px solid rgba(0,0,0,.12)}.torrent-files[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover   td[_ngcontent-%COMP%]{background-color:#f5f5f5}.torrent-files[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.files-count[_ngcontent-%COMP%]{margin-left:4px}.mat-mdc-card-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:0}span.filesize[_ngcontent-%COMP%]{text-decoration:underline;text-decoration-style:dotted;cursor:default}  .mdc-tab[aria-labelledby=hidden]{display:none}  .mdc-tab[role=tab]{padding-left:15px;padding-right:15px}  .mdc-tab .label,   .mdc-tab .files-count{margin-left:8px}"]})}}return t})();export{He as a,ut as b,Vi as c,Et as d,St as e,Me as f,Hi as g,dn as h,ke as i,qi as j,Cr as k};
