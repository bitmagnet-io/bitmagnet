import{g as J,j as A}from"./chunk-T2EFAQWC.js";import{E as T,G as Y,Ja as H,Ka as K,S as P,T as N,Ta as W,U as z,Ua as q,W as I,X as V,Y as y,b as k,i as w,la as R,o as M,p as L}from"./chunk-HX6RSO6I.js";import"./chunk-JGYM447R.js";import"./chunk-6GS6ZYTX.js";import{B as F,Db as x,Ea as m,Fa as _,Fb as h,Kb as Q,Lb as B,Mb as O,N as $,Nb as G,Ob as l,Pb as c,Qb as S,Rb as D,Sb as E,Ub as g,Xb as d,Zb as r,gc as u,hc as p,ib as a,ic as C,jc as U,lc as v,o as j,qa as f,ua as b}from"./chunk-IDBLIDSQ.js";function ce(i,o){if(i&1){let n=g();l(0,"section")(1,"mat-checkbox",4),d("change",function(t){m(n);let s=r(2);return s.localSearchDisabled=!t.checked,_(s.apisDisabled=s.localSearchDisabled?!0:s.apisDisabled)}),u(2),c(),l(3,"mat-checkbox",4),d("change",function(t){m(n);let s=r(2);return s.apisDisabled=!t.checked,_(s.localSearchDisabled=s.apisDisabled?s.localSearchDisabled:!0)}),u(4),c(),l(5,"mat-checkbox",4),d("change",function(t){m(n);let s=r(2);return _(s.classifierRematch=t.checked)}),u(6),c(),l(7,"mat-checkbox",4),d("change",function(t){m(n);let s=r(2);return _(s.orphans=t.checked)}),u(8),c()()}if(i&2){let n=r().$implicit,e=r();a(),h("checked",!e.apisDisabled),a(),p(n("dashboard.queues.match_content_by_local_search")),a(),h("checked",!e.apisDisabled),a(),p(n("dashboard.queues.match_content_by_external_api_search")),a(),h("checked",e.classifierRematch),a(),p(n("dashboard.queues.force_rematch")),a(),h("checked",e.orphans),a(),p(n("dashboard.queues.process_orphaned_torrents_only"))}}function le(i,o){i&1&&S(0,"mat-spinner")}function ue(i,o){if(i&1&&(l(0,"p"),u(1),c()),i&2){let n=r().$implicit;a(),p(n("dashboard.queues.jobs_enqueued"))}}function me(i,o){if(i&1){let n=g();D(0),l(1,"mat-card")(2,"h2",1),u(3),c(),l(4,"mat-dialog-content"),x(5,ce,9,8,"section")(6,le,1,0,"mat-spinner")(7,ue,2,1,"p"),c(),l(8,"mat-dialog-actions")(9,"button",2),d("click",function(){m(n);let t=r();return _(t.handleEnqueue())}),u(10),c(),l(11,"button",3),d("click",function(){m(n);let t=r();return _(t.dialogRef.close())}),u(12),c()()(),E()}if(i&2){let n=o.$implicit,e=r();a(3),C(" ",n("dashboard.queues.enqueue_torrent_processing_batch")," "),a(2),Q(e.stage==="PENDING"?5:e.stage==="REQUESTING"?6:e.stage==="DONE"?7:-1),a(4),h("disabled",e.stage!=="PENDING"),a(),C(" ",n("dashboard.queues.enqueue_jobs")," "),a(2),C(" ",n("general.dismiss")," ")}}var ne=(()=>{let o=class o{constructor(){this.apollo=f(w),this.dialogRef=f(N),this.availableQueueNames=A,this.statusNames=J,this.stage="PENDING",this.apisDisabled=!0,this.localSearchDisabled=!0,this.classifierRematch=!1,this.orphans=!1}handleEnqueue(){this.stage==="PENDING"&&(this.stage="REQUESTING",this.apollo.mutate({mutation:H,variables:{input:{apisDisabled:this.apisDisabled,localSearchDisabled:this.localSearchDisabled,classifierRematch:this.classifierRematch,contentTypes:this.contentTypes,orphans:this.orphans?!0:void 0}}}).subscribe(()=>{this.stage="DONE",this.data.onEnqueued?.()}))}};o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=b({type:o,selectors:[["app-queue-enqueue-reprocess-torrents-batch-dialog"]],standalone:!0,features:[v],decls:1,vars:0,consts:[[4,"transloco"],["mat-dialog-title",""],["mat-stroked-button","","color","warning",3,"click","disabled"],["mat-stroked-button","",3,"click"],[3,"change","checked"]],template:function(t,s){t&1&&x(0,me,13,5,"ng-container",0)},dependencies:[q,M,T,P,I,y,V,R,k],styles:["mat-dialog-content[_ngcontent-%COMP%]{min-height:240px;overflow:visible}mat-grid-tile[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]{width:100%;height:100%}"]});let i=o;return i})();function _e(i,o){if(i&1){let n=g();l(0,"mat-checkbox",6),d("change",function(t){m(n);let s=r(3);return _(s.handleQueueEvent(t))}),u(1),c()}if(i&2){let n=o.$implicit,e=r(3);h("value",n)("checked",e.queues==null?null:e.queues.includes(n)),a(),p(n)}}function de(i,o){if(i&1){let n=g();l(0,"mat-checkbox",6),d("change",function(t){m(n);let s=r(3);return _(s.handleStatusEvent(t))}),u(1),c()}if(i&2){let n=o.$implicit,e=r(3);h("value",n)("checked",e.statuses==null?null:e.statuses.includes(n)),a(),p(n)}}function pe(i,o){if(i&1){let n=g();l(0,"section")(1,"h4"),u(2),c(),l(3,"mat-checkbox",4),d("change",function(t){m(n);let s=r(2);return _(s.handleQueueEvent(t))}),u(4),c(),O(5,_e,2,3,"mat-checkbox",5,B),c(),l(7,"section")(8,"h4"),u(9,"Statuses:"),c(),l(10,"mat-checkbox",4),d("change",function(t){m(n);let s=r(2);return _(s.handleStatusEvent(t))}),u(11,"All"),c(),O(12,de,2,3,"mat-checkbox",5,B),c()}if(i&2){let n=r().$implicit,e=r();a(2),C("",n("dashboard.queues.queues"),":"),a(),h("checked",e.queues===void 0),a(),p(n("general.all")),a(),G(e.availableQueueNames),a(5),h("checked",e.statuses===void 0),a(2),G(e.statusNames)}}function he(i,o){i&1&&S(0,"mat-spinner")}function ge(i,o){if(i&1&&(l(0,"p"),u(1),c()),i&2){let n=r(2).$implicit,e=r();a(),U("",n("general.error"),": ",e.error.message,"")}}function xe(i,o){if(i&1&&(l(0,"p"),u(1),c()),i&2){let n=r(2).$implicit;a(),p(n("dashboard.queues.queue_purged"))}}function fe(i,o){if(i&1&&x(0,ge,2,2,"p")(1,xe,2,1,"p"),i&2){let n=r(2);Q(n.error?0:1)}}function Ce(i,o){if(i&1){let n=g();D(0),l(1,"mat-card")(2,"h2",1),u(3,"Purge Queue Jobs"),c(),l(4,"mat-dialog-content"),x(5,pe,14,4)(6,he,1,0,"mat-spinner")(7,fe,2,1),c(),l(8,"mat-dialog-actions")(9,"button",2),d("click",function(){m(n);let t=r();return _(t.handlePurgeJobs())}),u(10),c(),l(11,"button",3),d("click",function(){m(n);let t=r();return _(t.dialogRef.close())}),u(12),c()()(),E()}if(i&2){let n=o.$implicit,e=r();a(5),Q(e.stage==="PENDING"?5:e.stage==="REQUESTING"?6:e.stage==="DONE"?7:-1),a(4),h("disabled",e.stage!=="PENDING"),a(),C(" ",n("dashboard.queues.purge_jobs")," "),a(2),C(" ",n("general.dismiss")," ")}}var ie=(()=>{let o=class o{constructor(){this.apollo=f(w),this.dialogRef=f(N),this.availableQueueNames=A,this.statusNames=J,this.stage="PENDING"}handleQueueEvent(e){if(e.source.value==="_all"){this.queues=void 0;return}if(e.checked){let t=this.queues??[];t.includes(e.source.value)||(t=[...t,e.source.value]),t.length===this.availableQueueNames.length?(e.source.checked=!1,this.queues=void 0):this.queues=t}else{let t=this.queues?.filter(s=>s!==e.source.value);t?.length?this.queues=t:this.queues=void 0}}handleStatusEvent(e){if(e.source.value==="_all"){this.statuses=void 0;return}if(e.checked){let t=this.statuses??[];t.includes(e.source.value)||(t=[...t,e.source.value]),t.length===this.statusNames.length?(e.source.checked=!1,this.statuses=void 0):this.statuses=t}else{let t=this.statuses?.filter(s=>s!==e.source.value);t?.length?this.statuses=t:this.statuses=void 0}}handlePurgeJobs(){this.stage==="PENDING"&&(this.stage="REQUESTING",this.apollo.mutate({mutation:K,variables:{input:{queues:this.queues,statuses:this.statuses}}}).pipe($(e=>(this.stage="DONE",this.error=e,j)),F(()=>{this.stage="DONE",this.data.onPurged?.()})).subscribe())}};o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=b({type:o,selectors:[["app-queue-purge-jobs-dialog"]],standalone:!0,features:[v],decls:1,vars:0,consts:[[4,"transloco"],["mat-dialog-title",""],["mat-stroked-button","","color","warning",3,"click","disabled"],["mat-stroked-button","",3,"click"],["value","_all",3,"change","checked"],[3,"value","checked"],[3,"change","value","checked"]],template:function(t,s){t&1&&x(0,Ce,13,4,"ng-container",0)},dependencies:[q,M,T,P,I,y,V,R,k,W],styles:["mat-dialog-content[_ngcontent-%COMP%]{min-height:240px;overflow:visible}mat-grid-tile[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]{width:100%;height:100%}"]});let i=o;return i})();function be(i,o){if(i&1){let n=g();D(0),l(1,"mat-card")(2,"mat-card-content")(3,"ul")(4,"li")(5,"a",1),d("click",function(){m(n);let t=r();return _(t.openDialogPurgeJobs())}),u(6),c()(),l(7,"li")(8,"a",1),d("click",function(){m(n);let t=r();return _(t.openDialogEnqueueReprocessTorrentsBatch())}),u(9),c()()()()(),E()}if(i&2){let n=o.$implicit;a(6),p(n("dashboard.queues.purge_queue_jobs")),a(3),p(n("dashboard.queues.enqueue_torrent_processing_batch"))}}var ze=(()=>{let o=class o{constructor(){this.dialog=f(z)}openDialogPurgeJobs(){this.dialog.open(ie)}openDialogEnqueueReprocessTorrentsBatch(){this.dialog.open(ne)}};o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=b({type:o,selectors:[["app-queue-admin"]],standalone:!0,features:[v],decls:1,vars:0,consts:[[4,"transloco"],["mat-button","",3,"click"]],template:function(t,s){t&1&&x(0,be,10,2,"ng-container",0)},dependencies:[q,L,T,Y,k],styles:["ul[_ngcontent-%COMP%]{list-style-type:none;padding-left:0}ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:6px}"]});let i=o;return i})();export{ze as QueueAdminComponent};
