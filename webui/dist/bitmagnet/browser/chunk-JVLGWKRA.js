import{a as Fe,b as He,c as ee,d as Ue,e as Ge,f as te,g as Ke,h as Ye,i as Q,j as Je,k as We,l as Xe}from"./chunk-T2EFAQWC.js";import{a as Te,b as Re,c as I}from"./chunk-2HBTHCYO.js";import{e as Z}from"./chunk-ETNMUJWL.js";import{a as Se,j as qe,l as Ve}from"./chunk-AARZETA6.js";import{a as we}from"./chunk-QVQAV366.js";import{B as Be,E as K,F as Ee,G as Oe,J as Y,Na as Le,Ta as X,Ua as $e,Z as Ie,a as U,b as ve,ca as J,da as Ne,fa as W,ga as ze,ha as Pe,i as xe,ia as je,ka as Ae,n as Me,na as De,o as ye,oa as Qe,r as G}from"./chunk-HX6RSO6I.js";import"./chunk-JGYM447R.js";import"./chunk-6GS6ZYTX.js";import{B as ce,Db as de,Ea as b,Fa as g,Fb as u,Ib as z,Lb as P,Mb as j,N as le,Nb as A,Ob as s,Pb as l,Q as ne,Qb as H,Rb as fe,Sb as _e,Ub as re,Vc as Ce,Xb as k,Zb as f,a as y,b as S,gc as d,hc as T,ib as c,ic as he,ka as F,l as D,la as ue,lc as be,o as se,qa as V,qc as ge,rc as ke,ua as me,va as pe}from"./chunk-IDBLIDSQ.js";var Ze=(()=>{let n=class n{};n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=pe({type:n}),n.\u0275inj=ue({imports:[X,W,Ie,ye,G,K,Y,J,je,Pe]});let a=n;return a})();var lt={pending:"primary",processed:"success",failed:"error",retry:"caution"},et=(()=>{let n=class n{constructor(){this.themeInfo=V(Z),this.transloco=V(U)}create(i){let{colors:e}=this.themeInfo.info,o=Array(),r=[];if(i&&Array.from(new Set(i.queues.flatMap(C=>C.events?[C.events.earliestBucket,C.events.latestBucket]:[]))).sort().length){let C=i.queues.filter(m=>!m.isEmpty);o.push(...C.map(m=>m.queue));let h=Array();switch(i.params.event){case"created":h.push("pending");break;case"processed":h.push("processed");break;case"failed":h.push("retry","failed");break;default:h.push(...Ke);break}r.push(...h.map(m=>({label:m,data:C.map(_=>_.statusCounts[m]),backgroundColor:e[I(lt[m],50)]})))}return{type:"bar",options:{animation:!1,scales:{x:{ticks:{callback:x=>parseInt(x).toLocaleString(this.transloco.getActiveLang())}},y:{}},indexAxis:"y",plugins:{legend:{display:!0}}},data:{labels:o,datasets:r}}}};n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=F({token:n,factory:n.\u0275fac,providedIn:"root"});let a=n;return a})();var L="\\d+",oe="".concat(L,"(?:[\\.,]").concat(L,")?"),ut="(".concat(L,"Y)?(").concat(L,"M)?(").concat(L,"W)?(").concat(L,"D)?"),mt="T(".concat(oe,"H)?(").concat(oe,"M)?(").concat(oe,"S)?"),pt="P(?:".concat(ut,"(?:").concat(mt,")?)"),dt=["years","months","weeks","days","hours","minutes","seconds"],tt={years:0,months:0,weeks:0,days:0,hours:0,minutes:0,seconds:0},ft=new RegExp(pt),it=function(a){let n=a.replace(/,/g,".").match(ft);if(!n)throw new RangeError("invalid duration: ".concat(a));let t=n.slice(1);if(t.filter(function(i){return i!=null}).length===0)throw new RangeError("invalid duration: ".concat(a));if(t.filter(function(i){return/\./.test(i||"")}).length>1)throw new RangeError("only the smallest unit can be fractional");return t.reduce(function(i,e,o){return Object.assign(i,{[dt[o]]:parseFloat(e||"0")||0}),i},{})},_t=function(a,n){n||(n=new Date);let t=Object.assign({},tt,a),i=n.getTime(),e=new Date(i);e.setFullYear(e.getFullYear()+t.years),e.setMonth(e.getMonth()+t.months),e.setDate(e.getDate()+t.days);let o=t.hours*3600*1e3,r=t.minutes*60*1e3;return e.setMilliseconds(e.getMilliseconds()+t.seconds*1e3+o+r),e.setDate(e.getDate()+t.weeks*7),e},nt=function(a,n){n||(n=new Date);let t=Object.assign({},tt,a),i=n.getTime(),e=new Date(i),o=_t(t,e),r=n.getTimezoneOffset(),x=o.getTimezoneOffset(),C=(r-x)*60;return(o.getTime()-e.getTime())/1e3+C};var ie=class{constructor(n,t=Ue,i){this.apollo=n,this.errorsService=i,this.rawResultSubject=new D({queue:{metrics:{buckets:[]}}}),this.resultSubject=new D(Ge),this.result$=this.resultSubject.asObservable(),this.loadingSubject=new D(!1),this.paramsSubject=new D(t),this.params$=this.paramsSubject.asObservable(),this.variablesSubject=new D(rt(t)),this.paramsSubject.pipe(ne(50)).subscribe(e=>{let o=this.variablesSubject.getValue(),r=rt(e);JSON.stringify(o)!==JSON.stringify(r)?this.variablesSubject.next(r):this.resultSubject.next(ot(e,this.rawResultSubject.getValue()))}),this.variablesSubject.pipe(ne(50)).subscribe(e=>this.request(e)),this.rawResultSubject.subscribe(e=>{let o=this.paramsSubject.getValue();this.resultSubject.next(ot(o,e)),this.setInterval(o.autoRefresh)})}setInterval(n){clearTimeout(this.refreshTimeout);let t=Xe[n??this.params.autoRefresh];t&&(this.refreshTimeout=setTimeout(()=>{this.refresh()},t*1e3))}get params(){return this.paramsSubject.getValue()}get bucketDuration(){let n=this.params.buckets.duration;return n==="AUTO"?"hour":n}get bucketMultiplier(){return this.resultSubject.getValue().params.buckets.multiplier??this.params.buckets.multiplier}get loading(){return this.loadingSubject.getValue()}setTimeframe(n){this.updateParams(t=>S(y({},t),{buckets:S(y({},t.buckets),{timeframe:n})}))}setQueue(n){this.updateParams(t=>S(y({},t),{queue:n??void 0}))}setBucketDuration(n,t){this.updateParams(i=>S(y({},i),{buckets:S(y({},i.buckets),{duration:n,multiplier:t??"AUTO"})}))}setBucketMultiplier(n){this.updateParams(t=>S(y({},t),{buckets:S(y({},t.buckets),{multiplier:n})}))}setEvent(n){this.updateParams(t=>S(y({},t),{event:n??void 0}))}setAutoRefreshInterval(n){this.updateParams(t=>S(y({},t),{autoRefresh:n}))}updateParams(n){this.paramsSubject.next(n(this.params))}refresh(){this.variablesSubject.next(this.variablesSubject.getValue())}request(n){return clearTimeout(this.refreshTimeout),this.loadingSubject.next(!0),this.apollo.query({query:Le,variables:n,fetchPolicy:"no-cache"}).pipe(ce(t=>{t&&(this.loadingSubject.next(!1),this.rawResultSubject.next(t.data))})).pipe(le(t=>(this.errorsService.addError(`Failed to load queue metrics: ${t.message}`),this.loadingSubject.next(!1),this.setInterval(),se))).subscribe()}},rt=a=>({input:{bucketDuration:a.buckets.duration==="AUTO"?"hour":a.buckets.duration,queues:a.queue?[a.queue]:void 0,startTime:a.buckets.timeframe==="all"?void 0:new Date(new Date().getTime()-1e3*Q[a.buckets.timeframe]).toISOString()}}),at=a=>Object.fromEntries(a),ot=(a,n)=>{let{bucketParams:t,earliestBucket:i,latestBucket:e}=ht(a,n),o=Object.entries(n.queue.metrics.buckets.reduce((h,m)=>{if(m.queue!==(a.queue??m.queue))return h;let _,p;if((a.event??!0)&&(_=B(m.createdAtBucket,t),i&&i.index>_.index&&(_=void 0)),m.ranAtBucket&&a.event!=="created"&&(p=B(m.ranAtBucket,t),p&&(e.index<p.index||i&&i.index>p.index)&&(p=void 0)),m.queue!==a.queue&&!_&&(!p||m.status==="pending"))return h;let[v,w]=h[m.queue]??[Fe,[]],M=m.latency?nt(it(m.latency)):void 0;return S(y({},h),{[m.queue]:[(m.status==="pending"?_:p)?S(y({},v),{[m.status]:m.count+v[m.status]}):v,{created:_?S(y({},w.created),{[_.key]:{count:m.count+(w.created?.[_.key]?.count??0),latency:0,startTime:_.start}}):w.created,processed:p&&m.status==="processed"&&(a.event??!0)?S(y({},w.processed),{[p.key]:{count:m.count+(w.processed?.[p.key]?.count??0),latency:(w.processed?.[p.key]?.latency??0)+(M??0),startTime:p.start}}):w.processed,failed:p&&m.status==="failed"&&(a.event??!0)?S(y({},w.failed),{[p.key]:{count:m.count+(w.failed?.[p.key]?.count??0),latency:(w.failed?.[p.key]?.latency??0)+(M??0),startTime:p.start}}):w.failed}]})},{})).map(([h,[m,_]])=>{let p;if(Object.keys(_).length){let v=Array(),w=at(Array("created","processed","failed").flatMap(M=>{let E=at(Object.entries(_[M]??{}).filter(([,N])=>N?.count).sort(([N],[ct])=>parseInt(N)<parseInt(ct)?1:-1)),q=Object.keys(E);if(!q.length)return[];let O=parseInt(q[0]),R=parseInt(q[q.length-1]);return v.push(O,R),[[M,{earliestBucket:O,latestBucket:R,entries:E}]]}));v.sort(),p={bucketDuration:t.duration,earliestBucket:v[0],latestBucket:v[v.length-1],eventBuckets:w}}return{queue:h,statusCounts:m,events:p,isEmpty:!p?.eventBuckets}}),r,x=o.flatMap(h=>h.events?[h.events.earliestBucket]:[]).sort()[0],C=o.flatMap(h=>h.events?[h.events.latestBucket]:[]).sort().reverse()[0];return x&&C&&(r={earliestBucket:x,latestBucket:C}),{params:S(y({},a),{buckets:t}),queues:o,bucketSpan:r}},ht=(a,n)=>{let t=a.buckets.duration==="AUTO"?"hour":a.buckets.duration,i=a.buckets.multiplier==="AUTO"?1:a.buckets.multiplier,e=a.buckets.timeframe,o=new Date,r=B(o,{duration:t,multiplier:i}),x=e==="all"?void 0:B(o.getTime()-1e3*Q[e],{duration:t,multiplier:i}),C=[...x?[x]:[],...n.queue.metrics.buckets.flatMap(_=>[B(_.createdAtBucket,{duration:t,multiplier:i}),..._.ranAtBucket?[B(_.ranAtBucket,{duration:t,multiplier:i})]:[]]),r].filter(_=>!x||_.index>=x.index).sort((_,p)=>_.index-p.index),h=C[0],m=C[C.length-1];if(a.buckets.multiplier==="AUTO"){let p=m.index-h.index;i=Math.min(60,Math.max(Math.floor(p/(20*5))*5,1))}return{bucketParams:{duration:t,multiplier:i,timeframe:e},earliestBucket:e==="all"?void 0:B(o.getTime()-1e3*Q[e],{duration:t,multiplier:i}),latestBucket:B(Math.max(o.getTime(),m.start.getTime()),{duration:t,multiplier:i})}},B=(a,n)=>{let t=new Date(a),i=1e3*ee[n.duration]*n.multiplier,e=Math.floor(t.getTime()/i);return{key:`${e}`,index:e,start:new Date(e*i)}};var $={created:"primary",processed:"success",failed:"error"},st=(()=>{let n=class n{constructor(){this.themeInfo=V(Z),this.transloco=V(U)}create(i){let{colors:e}=this.themeInfo.info,o=Array(),r=[];if(i){let x=i.queues.filter(p=>!p.isEmpty),C=Array.from(new Set(x.flatMap(p=>p.events?[p.events.earliestBucket,p.events.latestBucket]:[]))).sort(),h=new Date,m=i.params.buckets.timeframe==="all"?C[0]:Math.min(C[0],B(h.getTime()-1e3*Q[i.params.buckets.timeframe],i.params.buckets).index),_=Math.max(C[C.length-1],B(h,i.params.buckets).index);if(C.length){for(let v=m;v<=_;v++)o.push(this.formatBucketKey(i.params.buckets,v));let p=te.filter(v=>(i.params.event??v)===v);for(let v of x){for(let M of p){let E=Array();for(let q=m;q<=_;q++)E.push(v.events?.eventBuckets?.[M]?.entries?.[`${q}`]?.count??0);r.push({yAxisID:"yCount",label:[v.queue,M].join("/"),data:E,borderColor:e[I($[M],50)],pointBackgroundColor:e[I($[M],20)],pointBorderColor:e[I($[M],80)],pointHoverBackgroundColor:e[I($[M],40)],pointHoverBorderColor:e[I($[M],60)]})}if(["processed","failed"].filter(M=>p.includes(M)).length){let M=Array();for(let E=m;E<=_;E++){let q=["processed","failed"].filter(O=>p.includes(O)).reduce((O,R)=>{let N=v.events?.eventBuckets?.[R]?.entries?.[`${E}`];return N?.count?[(O?.[0]??0)+N.latency,(O?.[1]??0)+N.count]:O},null);M.push(q?q[0]/q[1]:null)}r.push({yAxisID:"yLatency",label:[v.queue,"latency"].join("/"),data:M,borderColor:e["tertiary-50"],pointHoverBackgroundColor:e["tertiary-80"],pointHoverBorderColor:e["tertiary-20"]})}}}}return{type:"line",options:{animation:!1,elements:{line:{tension:.5}},scales:{yCount:{position:"left",ticks:{callback:x=>parseInt(x).toLocaleString(this.transloco.getActiveLang())}},yLatency:{position:"right",ticks:{callback:this.formatDuration.bind(this)}}},plugins:{legend:{display:!0},decimation:{enabled:!0}}},data:{labels:o,datasets:r}}}formatBucketKey(i,e){let o;switch(i.duration){case"day":o="d LLL";break;case"hour":o="d LLL H:00";break;case"minute":o="H:mm";break}return Te(1e3*ee[i.duration]*i.multiplier*e,o,{locale:qe(this.transloco.getActiveLang())})}formatDuration(i){if(typeof i=="string"&&(i=parseInt(i)),i===0)return"0";let e=i,o=0,r=0,x=0;return e>=60&&(o=Math.floor(e/60),e=e%60,o>=5&&(e=0,o>=60&&(r=Math.floor(o/60),o=o%60,r>=5&&(o=0,r>=24&&(x=Math.floor(r/24),r=r%24))))),Ve({days:x,hours:r,minutes:o,seconds:e},this.transloco.getActiveLang())}};n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=F({token:n,factory:n.\u0275fac,providedIn:"root"});let a=n;return a})();function bt(a,n){if(a&1&&(s(0,"mat-option",6),d(1),l()),a&2){let t=n.$implicit,i=f().$implicit;u("value",t),c(),T(i("dashboard.interval."+t))}}function gt(a,n){if(a&1&&(s(0,"mat-option",6),d(1),l()),a&2){let t=n.$implicit,i=f().$implicit;u("value",t),c(),T(i("dashboard.interval."+t+"s"))}}function kt(a,n){if(a&1&&(s(0,"mat-option",6),d(1),l()),a&2){let t=n.$implicit;u("value",t),c(),T(t)}}function Ct(a,n){if(a&1){let t=re();s(0,"button",17),k("click",function(){let e=b(t).$implicit,o=f(2);return g(o.queueMetricsController.params.queue===e||o.queueMetricsController.setQueue(e))}),s(1,"mat-icon"),d(2),l()()}if(a&2){let t=n.$implicit,i=f(2);z(i.queueMetricsController.params.queue===t?"selected":"deselected"),u("matTooltip",t),c(2),T(i.queueMetricsController.params.queue===t?"radio_button_checked":"radio_button_unchecked")}}function vt(a,n){if(a&1&&(s(0,"mat-option",6),d(1),l()),a&2){let t=n.$implicit,i=f().$implicit;u("value",t),c(),T(i("dashboard.event."+t))}}function xt(a,n){if(a&1&&(s(0,"mat-option",6),d(1),l()),a&2){let t=n.$implicit,i=f().$implicit;u("value",t),c(),T(i("dashboard.interval."+t))}}function Mt(a,n){if(a&1){let t=re();fe(0),s(1,"mat-card")(2,"mat-card-content")(3,"mat-grid-list",1)(4,"mat-grid-tile",2)(5,"mat-card",3)(6,"mat-card-header")(7,"mat-card-title")(8,"h4"),d(9),l()()(),s(10,"mat-card-content")(11,"mat-form-field",4)(12,"mat-select",5),k("valueChange",function(e){b(t);let o=f();return g(o.queueMetricsController.setTimeframe(e))}),j(13,bt,2,2,"mat-option",6,P),l()(),s(15,"div",7)(16,"button",8),k("click",function(){b(t);let e=f();return g(e.queueMetricsController.setTimeframe(e.timeframeNames[0]))}),s(17,"mat-icon"),d(18,"first_page"),l()(),s(19,"button",8),k("click",function(){b(t);let e=f();return g(e.queueMetricsController.setTimeframe(e.timeframeNames[e.timeframeNames.indexOf(e.queueMetricsController.params.buckets.timeframe)-1]))}),s(20,"mat-icon"),d(21,"navigate_before"),l()(),s(22,"button",8),k("click",function(){b(t);let e=f();return g(e.queueMetricsController.setTimeframe(e.timeframeNames[e.timeframeNames.indexOf(e.queueMetricsController.params.buckets.timeframe)+1]))}),s(23,"mat-icon"),d(24,"navigate_next"),l()(),s(25,"button",8),k("click",function(){b(t);let e=f();return g(e.queueMetricsController.setTimeframe(e.timeframeNames[e.timeframeNames.length-1]))}),s(26,"mat-icon"),d(27,"last_page"),l()()()()()(),s(28,"mat-grid-tile",2)(29,"mat-card",9)(30,"mat-card-header")(31,"mat-card-title")(32,"h4"),d(33),l()()(),s(34,"mat-card-content")(35,"mat-form-field",10)(36,"input",11),ge(37,"async"),k("change",function(e){b(t);let o=f();return g(o.handleMultiplierEvent(e))}),l()(),s(38,"mat-form-field",12)(39,"mat-select",5),k("valueChange",function(e){b(t);let o=f();return g(o.queueMetricsController.setBucketDuration(e))}),j(40,gt,2,2,"mat-option",6,P),l()(),s(42,"div",7)(43,"button",8),k("click",function(){b(t);let e=f();return g(e.queueMetricsController.setBucketMultiplier(e.queueMetricsController.bucketMultiplier-1))}),s(44,"mat-icon"),d(45,"remove"),l()(),s(46,"button",13),k("click",function(){b(t);let e=f();return g(e.queueMetricsController.setBucketMultiplier(e.queueMetricsController.bucketMultiplier+1))}),s(47,"mat-icon"),d(48,"add"),l()(),s(49,"button",8),k("click",function(){b(t);let e=f();return g(e.queueMetricsController.setBucketDuration(e.resolutionNames[0]))}),s(50,"mat-icon"),d(51,"first_page"),l()(),s(52,"button",8),k("click",function(){b(t);let e=f();return g(e.queueMetricsController.setBucketDuration(e.resolutionNames[e.resolutionNames.indexOf(e.queueMetricsController.bucketDuration)-1]))}),s(53,"mat-icon"),d(54,"navigate_before"),l()(),s(55,"button",8),k("click",function(){b(t);let e=f();return g(e.queueMetricsController.setBucketDuration(e.resolutionNames[e.resolutionNames.indexOf(e.queueMetricsController.bucketDuration)+1]))}),s(56,"mat-icon"),d(57,"navigate_next"),l()(),s(58,"button",8),k("click",function(){b(t);let e=f();return g(e.queueMetricsController.setBucketDuration(e.resolutionNames[e.resolutionNames.length-1]))}),s(59,"mat-icon"),d(60,"last_page"),l()()()()()(),s(61,"mat-grid-tile",2)(62,"mat-card",14)(63,"mat-card-header")(64,"mat-card-title")(65,"h4"),d(66),l()()(),s(67,"mat-card-content")(68,"mat-form-field",4)(69,"mat-select",5),k("valueChange",function(e){b(t);let o=f();return g(o.queueMetricsController.setQueue(e==="_all"?null:e))}),s(70,"mat-option",15),d(71),l(),j(72,kt,2,2,"mat-option",6,P),l()(),s(74,"div",16)(75,"button",17),k("click",function(){b(t);let e=f();return g(e.queueMetricsController.setQueue(null))}),s(76,"mat-icon",18),d(77,"workspaces"),l()(),j(78,Ct,3,4,"button",19,P),l()()()(),s(80,"mat-grid-tile",2)(81,"mat-card")(82,"mat-card-header")(83,"mat-card-title")(84,"h4"),d(85),l()()(),s(86,"mat-card-content")(87,"mat-form-field",4)(88,"mat-select",5),k("valueChange",function(e){b(t);let o=f();return g(o.queueMetricsController.setEvent(e==="_all"?null:e))}),s(89,"mat-option",15),d(90,"All"),l(),j(91,vt,2,2,"mat-option",6,P),l()(),s(93,"div",16)(94,"button",17),k("click",function(){b(t);let e=f();return g(e.queueMetricsController.setEvent(null))}),s(95,"mat-icon",18),d(96,"radio_button_checked"),l()(),s(97,"button",17),k("click",function(){b(t);let e=f();return g(e.queueMetricsController.params.event==="created"||e.queueMetricsController.setEvent("created"))}),s(98,"mat-icon"),d(99,"add_circle"),l()(),s(100,"button",17),k("click",function(){b(t);let e=f();return g(e.queueMetricsController.params.event==="processed"||e.queueMetricsController.setEvent("processed"))}),s(101,"mat-icon"),d(102,"check_circle"),l()(),s(103,"button",17),k("click",function(){b(t);let e=f();return g(e.queueMetricsController.params.event==="failed"||e.queueMetricsController.setEvent("failed"))}),s(104,"mat-icon"),d(105,"error"),l()()()()()(),s(106,"mat-grid-tile",2)(107,"mat-card",20)(108,"mat-card-header")(109,"mat-card-title")(110,"h4"),d(111),l()()(),s(112,"mat-card-content")(113,"mat-form-field",4)(114,"mat-select",5),k("valueChange",function(e){b(t);let o=f();return g(o.queueMetricsController.setAutoRefreshInterval(e))}),j(115,xt,2,2,"mat-option",6,P),l()(),s(117,"div",16)(118,"button",17),k("click",function(){b(t);let e=f();return g(e.queueMetricsController.refresh())}),s(119,"mat-icon"),d(120,"sync"),l()()()()()()(),s(121,"div",21),H(122,"mat-progress-bar",22),l(),s(123,"mat-grid-list",1)(124,"mat-grid-tile",2)(125,"mat-card")(126,"mat-card-header")(127,"mat-card-title")(128,"h4"),d(129),l()()(),s(130,"mat-card-content"),H(131,"app-chart",23),l()()(),s(132,"mat-grid-tile",2)(133,"mat-card")(134,"mat-card-header")(135,"mat-card-title")(136,"h4"),d(137),l()()(),s(138,"mat-card-content"),H(139,"app-chart",23),l()()()()()(),_e()}if(a&2){let t,i,e,o=n.$implicit,r=f();c(3),u("cols",r.breakpoints.sizeAtLeast("Large")?5:r.breakpoints.sizeAtLeast("Medium")?3:r.breakpoints.sizeAtLeast("Small")?2:1),c(),u("colspan",1)("rowspan",2),c(5),T(o("dashboard.metrics.timeframe")),c(3),u("value",r.queueMetricsController.params.buckets.timeframe),c(),A(r.timeframeNames),c(3),u("disabled",r.timeframeNames.indexOf(r.queueMetricsController.params.buckets.timeframe)<=0),c(3),u("disabled",r.timeframeNames.indexOf(r.queueMetricsController.params.buckets.timeframe)<=0),c(3),u("disabled",r.timeframeNames.indexOf(r.queueMetricsController.params.buckets.timeframe)>=r.timeframeNames.length-1),c(3),u("disabled",r.timeframeNames.indexOf(r.queueMetricsController.params.buckets.timeframe)>=r.timeframeNames.length-1),c(3),u("colspan",1)("rowspan",2),c(5),he(" ",o("dashboard.metrics.resolution")," "),c(3),u("placeholder",(t=(t=ke(37,66,r.queueMetricsController.result$))==null||t.params==null||t.params.buckets==null||t.params.buckets.multiplier==null?null:t.params.buckets.multiplier.toString())!==null&&t!==void 0?t:"")("value",r.queueMetricsController.params.buckets.multiplier),c(3),u("value",r.queueMetricsController.bucketDuration),c(),A(r.resolutionNames),c(3),u("disabled",r.queueMetricsController.bucketMultiplier===1),c(6),u("disabled",r.resolutionNames.indexOf(r.queueMetricsController.bucketDuration)<=0),c(3),u("disabled",r.resolutionNames.indexOf(r.queueMetricsController.bucketDuration)<=0),c(3),u("disabled",r.resolutionNames.indexOf(r.queueMetricsController.bucketDuration)>=r.resolutionNames.length-1),c(3),u("disabled",r.resolutionNames.indexOf(r.queueMetricsController.bucketDuration)>=r.resolutionNames.length-1),c(3),u("colspan",1)("rowspan",2),c(5),T(o("dashboard.queues.queue")),c(3),u("value",(i=r.queueMetricsController.params.queue)!==null&&i!==void 0?i:"_all"),c(2),T(o("general.all")),c(),A(r.availableQueueNames),c(3),z(r.queueMetricsController.params.queue?"deselected":"selected"),u("matTooltip",o("general.all")),c(3),A(r.availableQueueNames),c(2),u("colspan",1)("rowspan",2),c(5),T(o("dashboard.metrics.event")),c(3),u("value",(e=r.queueMetricsController.params.event)!==null&&e!==void 0?e:"_all"),c(3),A(r.eventNames),c(3),z(r.queueMetricsController.params.event?"deselected":"selected"),u("matTooltip",o("general.all")),c(3),z(r.queueMetricsController.params.event==="created"?"selected":"deselected"),u("matTooltip",o("dashboard.queues.created")),c(3),z(r.queueMetricsController.params.event==="processed"?"selected":"deselected"),u("matTooltip",o("dashboard.queues.processed")),c(3),z(r.queueMetricsController.params.event==="failed"?"selected":"deselected"),u("matTooltip",o("dashboard.queues.failed")),c(3),u("colspan",1)("rowspan",2),c(5),T(o("general.refresh")),c(3),u("value",r.queueMetricsController.params.autoRefresh),c(),A(r.autoRefreshIntervalNames),c(3),u("matTooltip",o("general.refresh")),c(4),u("mode",r.queueMetricsController.loading?"indeterminate":"determinate")("value",0),c(),u("cols",r.breakpoints.sizeAtLeast("Large")?2:1),c(),u("colspan",1)("rowspan",5),c(5),T(o("dashboard.queues.total_counts_by_status")),c(2),u("adapter",r.totals)("$data",r.queueMetricsController.result$)("height",400)("width",550),c(),u("colspan",1)("rowspan",5),c(5),T(o("dashboard.metrics.throughput")),c(2),u("adapter",r.timeline)("$data",r.queueMetricsController.result$)("height",400)("width",550)}}var Ni=(()=>{let n=class n{constructor(){this.breakpoints=V(we),this.apollo=V(xe),this.queueMetricsController=new ie(this.apollo,{buckets:{duration:"AUTO",multiplier:"AUTO",timeframe:"all"},autoRefresh:"seconds_30"},V(Se)),this.timeline=V(st),this.totals=V(et),this.resolutionNames=He,this.timeframeNames=Ye,this.availableQueueNames=Je,this.autoRefreshIntervalNames=We,this.eventNames=te}ngOnInit(){this.queueMetricsController.result$.subscribe(i=>{if(this.queueMetricsController.params.buckets.timeframe==="all"&&this.queueMetricsController.params.buckets.duration==="AUTO"&&i.params.buckets.duration==="hour"){let e=i.bucketSpan;e&&e.latestBucket-e.earliestBucket<12&&this.queueMetricsController.setBucketDuration("minute")}})}ngOnDestroy(){this.queueMetricsController.setAutoRefreshInterval("off")}handleMultiplierEvent(i){let e=i.currentTarget.value;this.queueMetricsController.setBucketMultiplier(/^\d+$/.test(e)?parseInt(e):"AUTO")}};n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=me({type:n,selectors:[["app-queue-visualize"]],standalone:!0,features:[be],decls:1,vars:0,consts:[[4,"transloco"],["rowHeight","100px",3,"cols"],[3,"colspan","rowspan"],[1,"form-timeframe"],["subscriptSizing","dynamic"],[3,"valueChange","value"],[3,"value"],[1,"paginator","actions"],["mat-icon-button","",3,"click","disabled"],[1,"form-resolution"],["subscriptSizing","dynamic",1,"form-input-multiplier"],["type","number","matInput","","min","1","step","1",3,"change","placeholder","value"],["subscriptSizing","dynamic",1,"form-select-duration"],["mat-icon-button","",3,"click"],[1,"form-queues"],["value","_all"],[1,"actions"],["mat-icon-button","",3,"click","matTooltip"],["fontSet","material-icons"],["mat-icon-button","",3,"class","matTooltip"],[1,"form-refresh"],[1,"progress-bar-container"],[3,"mode","value"],[3,"adapter","$data","height","width"]],template:function(e,o){e&1&&de(0,Mt,140,68,"ng-container",0)},dependencies:[$e,Me,G,K,Oe,Y,Ee,Be,Ne,J,W,ze,Ae,Qe,De,ve,Ce,Re,X,Ze],styles:[".actions[_ngcontent-%COMP%]{width:210px;padding-top:12px;--mdc-icon-button-state-layer-size: 32px}.actions[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:22px}.actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-right:0}.progress-bar-container[_ngcontent-%COMP%]{width:100%;height:10px}mat-grid-tile[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]{width:100%}mat-grid-tile[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{min-width:190px}mat-grid-tile[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin-bottom:16px;font-size:18px}mat-form-field[_ngcontent-%COMP%]{width:186px}.form-resolution[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{margin-left:-2px}.form-resolution[_ngcontent-%COMP%]   .form-input-multiplier[_ngcontent-%COMP%]{width:60px;margin-right:10px}.form-resolution[_ngcontent-%COMP%]   .form-input-multiplier[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::-webkit-outer-spin-button, .form-resolution[_ngcontent-%COMP%]   .form-input-multiplier[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.form-resolution[_ngcontent-%COMP%]   .form-input-multiplier[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}.form-resolution[_ngcontent-%COMP%]   .form-select-duration[_ngcontent-%COMP%]{width:116px}"]});let a=n;return a})();export{Ni as QueueVisualizeComponent};
