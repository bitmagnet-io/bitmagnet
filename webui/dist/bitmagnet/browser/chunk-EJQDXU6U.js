import{g as J,j as A}from"./chunk-6OKZFKY7.js";import{A as z,J as H,P as k,R as K,Ua as q,b as T,ba as M,ca as N,da as W,fa as I,ga as V,ha as y,i as w,o as P,p as L,wa as R,z as Y}from"./chunk-HB55W55I.js";import"./chunk-6XXA7HXI.js";import"./chunk-ZBBMS7J5.js";import{$b as a,B as F,Cb as x,Ea as m,Fa as _,Hb as g,Mb as Q,N as $,Nb as B,Ob as O,Pb as G,Qb as s,Rb as r,Sb as S,Tb as D,Ub as E,Wb as h,Zb as d,kb as o,kc as c,lc as p,mc as C,nc as U,o as j,pc as v,qa as f,ua as b}from"./chunk-FJILXII2.js";function ce(n,u){if(n&1){let e=h();s(0,"section")(1,"mat-checkbox",4),d("change",function(i){m(e);let l=a(2);return l.localSearchDisabled=!i.checked,_(l.apisDisabled=l.localSearchDisabled?!0:l.apisDisabled)}),c(2),r(),s(3,"mat-checkbox",4),d("change",function(i){m(e);let l=a(2);return l.apisDisabled=!i.checked,_(l.localSearchDisabled=l.apisDisabled?l.localSearchDisabled:!0)}),c(4),r(),s(5,"mat-checkbox",4),d("change",function(i){m(e);let l=a(2);return _(l.classifierRematch=i.checked)}),c(6),r(),s(7,"mat-checkbox",4),d("change",function(i){m(e);let l=a(2);return _(l.orphans=i.checked)}),c(8),r()()}if(n&2){let e=a().$implicit,t=a();o(),g("checked",!t.apisDisabled),o(),p(e("dashboard.queues.match_content_by_local_search")),o(),g("checked",!t.apisDisabled),o(),p(e("dashboard.queues.match_content_by_external_api_search")),o(),g("checked",t.classifierRematch),o(),p(e("dashboard.queues.force_rematch")),o(),g("checked",t.orphans),o(),p(e("dashboard.queues.process_orphaned_torrents_only"))}}function le(n,u){n&1&&S(0,"mat-spinner")}function ue(n,u){if(n&1&&(s(0,"p"),c(1),r()),n&2){let e=a().$implicit;o(),p(e("dashboard.queues.jobs_enqueued"))}}function me(n,u){if(n&1){let e=h();D(0),s(1,"mat-card")(2,"h2",1),c(3),r(),s(4,"mat-dialog-content"),x(5,ce,9,8,"section")(6,le,1,0,"mat-spinner")(7,ue,2,1,"p"),r(),s(8,"mat-dialog-actions")(9,"button",2),d("click",function(){m(e);let i=a();return _(i.handleEnqueue())}),c(10),r(),s(11,"button",3),d("click",function(){m(e);let i=a();return _(i.dialogRef.close())}),c(12),r()()(),E()}if(n&2){let e=u.$implicit,t=a();o(3),C(" ",e("dashboard.queues.enqueue_torrent_processing_batch")," "),o(2),Q(t.stage==="PENDING"?5:t.stage==="REQUESTING"?6:t.stage==="DONE"?7:-1),o(4),g("disabled",t.stage!=="PENDING"),o(),C(" ",e("dashboard.queues.enqueue_jobs")," "),o(2),C(" ",e("general.dismiss")," ")}}var ne=(()=>{class n{constructor(){this.apollo=f(w),this.dialogRef=f(N),this.availableQueueNames=A,this.statusNames=J,this.stage="PENDING",this.apisDisabled=!0,this.localSearchDisabled=!0,this.classifierRematch=!1,this.orphans=!1}handleEnqueue(){this.stage==="PENDING"&&(this.stage="REQUESTING",this.apollo.mutate({mutation:Y,variables:{input:{apisDisabled:this.apisDisabled,localSearchDisabled:this.localSearchDisabled,classifierRematch:this.classifierRematch,contentTypes:this.contentTypes,orphans:this.orphans?!0:void 0}}}).subscribe(()=>{this.stage="DONE",this.data.onEnqueued?.()}))}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=b({type:n,selectors:[["app-queue-enqueue-reprocess-torrents-batch-dialog"]],standalone:!0,features:[v],decls:1,vars:0,consts:[[4,"transloco"],["mat-dialog-title",""],["mat-stroked-button","","color","warning",3,"click","disabled"],["mat-stroked-button","",3,"click"],[3,"change","checked"]],template:function(t,i){t&1&&x(0,me,13,5,"ng-container",0)},dependencies:[q,P,k,M,I,y,V,R,T],styles:["mat-dialog-content[_ngcontent-%COMP%]{min-height:240px;overflow:visible}mat-grid-tile[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]{width:100%;height:100%}"]})}}return n})();function _e(n,u){if(n&1){let e=h();s(0,"mat-checkbox",6),d("change",function(i){m(e);let l=a(3);return _(l.handleQueueEvent(i))}),c(1),r()}if(n&2){let e=u.$implicit,t=a(3);g("value",e)("checked",t.queues==null?null:t.queues.includes(e)),o(),p(e)}}function de(n,u){if(n&1){let e=h();s(0,"mat-checkbox",6),d("change",function(i){m(e);let l=a(3);return _(l.handleStatusEvent(i))}),c(1),r()}if(n&2){let e=u.$implicit,t=a(3);g("value",e)("checked",t.statuses==null?null:t.statuses.includes(e)),o(),p(e)}}function pe(n,u){if(n&1){let e=h();s(0,"section")(1,"h4"),c(2),r(),s(3,"mat-checkbox",4),d("change",function(i){m(e);let l=a(2);return _(l.handleQueueEvent(i))}),c(4),r(),O(5,_e,2,3,"mat-checkbox",5,B),r(),s(7,"section")(8,"h4"),c(9,"Statuses:"),r(),s(10,"mat-checkbox",4),d("change",function(i){m(e);let l=a(2);return _(l.handleStatusEvent(i))}),c(11,"All"),r(),O(12,de,2,3,"mat-checkbox",5,B),r()}if(n&2){let e=a().$implicit,t=a();o(2),C("",e("dashboard.queues.queues"),":"),o(),g("checked",t.queues===void 0),o(),p(e("general.all")),o(),G(t.availableQueueNames),o(5),g("checked",t.statuses===void 0),o(2),G(t.statusNames)}}function ge(n,u){n&1&&S(0,"mat-spinner")}function he(n,u){if(n&1&&(s(0,"p"),c(1),r()),n&2){let e=a(2).$implicit,t=a();o(),U("",e("general.error"),": ",t.error.message,"")}}function xe(n,u){if(n&1&&(s(0,"p"),c(1),r()),n&2){let e=a(2).$implicit;o(),p(e("dashboard.queues.queue_purged"))}}function fe(n,u){if(n&1&&x(0,he,2,2,"p")(1,xe,2,1,"p"),n&2){let e=a(2);Q(e.error?0:1)}}function Ce(n,u){if(n&1){let e=h();D(0),s(1,"mat-card")(2,"h2",1),c(3,"Purge Queue Jobs"),r(),s(4,"mat-dialog-content"),x(5,pe,14,4)(6,ge,1,0,"mat-spinner")(7,fe,2,1),r(),s(8,"mat-dialog-actions")(9,"button",2),d("click",function(){m(e);let i=a();return _(i.handlePurgeJobs())}),c(10),r(),s(11,"button",3),d("click",function(){m(e);let i=a();return _(i.dialogRef.close())}),c(12),r()()(),E()}if(n&2){let e=u.$implicit,t=a();o(5),Q(t.stage==="PENDING"?5:t.stage==="REQUESTING"?6:t.stage==="DONE"?7:-1),o(4),g("disabled",t.stage!=="PENDING"),o(),C(" ",e("dashboard.queues.purge_jobs")," "),o(2),C(" ",e("general.dismiss")," ")}}var ie=(()=>{class n{constructor(){this.apollo=f(w),this.dialogRef=f(N),this.availableQueueNames=A,this.statusNames=J,this.stage="PENDING"}handleQueueEvent(e){if(e.source.value==="_all"){this.queues=void 0;return}if(e.checked){let t=this.queues??[];t.includes(e.source.value)||(t=[...t,e.source.value]),t.length===this.availableQueueNames.length?(e.source.checked=!1,this.queues=void 0):this.queues=t}else{let t=this.queues?.filter(i=>i!==e.source.value);t?.length?this.queues=t:this.queues=void 0}}handleStatusEvent(e){if(e.source.value==="_all"){this.statuses=void 0;return}if(e.checked){let t=this.statuses??[];t.includes(e.source.value)||(t=[...t,e.source.value]),t.length===this.statusNames.length?(e.source.checked=!1,this.statuses=void 0):this.statuses=t}else{let t=this.statuses?.filter(i=>i!==e.source.value);t?.length?this.statuses=t:this.statuses=void 0}}handlePurgeJobs(){this.stage==="PENDING"&&(this.stage="REQUESTING",this.apollo.mutate({mutation:z,variables:{input:{queues:this.queues,statuses:this.statuses}}}).pipe($(e=>(this.stage="DONE",this.error=e,j)),F(()=>{this.stage="DONE",this.data.onPurged?.()})).subscribe())}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=b({type:n,selectors:[["app-queue-purge-jobs-dialog"]],standalone:!0,features:[v],decls:1,vars:0,consts:[[4,"transloco"],["mat-dialog-title",""],["mat-stroked-button","","color","warning",3,"click","disabled"],["mat-stroked-button","",3,"click"],["value","_all",3,"change","checked"],[3,"value","checked"],[3,"change","value","checked"]],template:function(t,i){t&1&&x(0,Ce,13,4,"ng-container",0)},dependencies:[q,P,k,M,I,y,V,R,T,H],styles:["mat-dialog-content[_ngcontent-%COMP%]{min-height:240px;overflow:visible}mat-grid-tile[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]{width:100%;height:100%}"]})}}return n})();function be(n,u){if(n&1){let e=h();D(0),s(1,"mat-card")(2,"mat-card-content")(3,"ul")(4,"li")(5,"a",1),d("click",function(){m(e);let i=a();return _(i.openDialogPurgeJobs())}),c(6),r()(),s(7,"li")(8,"a",1),d("click",function(){m(e);let i=a();return _(i.openDialogEnqueueReprocessTorrentsBatch())}),c(9),r()()()()(),E()}if(n&2){let e=u.$implicit;o(6),p(e("dashboard.queues.purge_queue_jobs")),o(3),p(e("dashboard.queues.enqueue_torrent_processing_batch"))}}var ze=(()=>{class n{constructor(){this.dialog=f(W)}openDialogPurgeJobs(){this.dialog.open(ie)}openDialogEnqueueReprocessTorrentsBatch(){this.dialog.open(ne)}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=b({type:n,selectors:[["app-queue-admin"]],standalone:!0,features:[v],decls:1,vars:0,consts:[[4,"transloco"],["mat-button","",3,"click"]],template:function(t,i){t&1&&x(0,be,10,2,"ng-container",0)},dependencies:[q,L,k,K,T],styles:["ul[_ngcontent-%COMP%]{list-style-type:none;padding-left:0}ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:6px}"]})}}return n})();export{ze as QueueAdminComponent};
